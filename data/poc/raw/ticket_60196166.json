{
  "payload": {
    "ticket": {
      "metadata": {
        "product": "aurea_kerio_control",
        "requester": {
          "id": 60215103,
          "uuid": "c0f7dffe-6fa2-42ab-b282-16aeccd46ce2",
          "full_name": "Slawomir Burak",
          "legacy_id": "370086887753",
          "designation": null,
          "is_enabled": true,
          "is_mfa_enabled": false,
          "role": {
            "id": 4,
            "resource_type": "role"
          },
          "avatar": "https://central-supportdesk.kayako.com/avatar/get/c0f7dffe-6fa2-42ab-b282-16aeccd46ce2?1766155848",
          "agent_case_access": null,
          "organization_case_access": "ORGANIZATION",
          "organization": {
            "id": 60028769,
            "resource_type": "organization"
          },
          "teams": [],
          "emails": [
            {
              "id": 216638,
              "resource_type": "identity_email"
            }
          ],
          "phones": [],
          "twitter": [],
          "facebook": [],
          "external_identifiers": [],
          "custom_fields": [
            {
              "field": {
                "id": 1,
                "resource_type": "user_field"
              },
              "value": "",
              "resource_type": "user_field_value"
            },
            {
              "field": {
                "id": 2,
                "resource_type": "user_field"
              },
              "value": "",
              "resource_type": "user_field_value"
            }
          ],
          "pinned_notes_count": 0,
          "locale": {
            "id": 3,
            "resource_type": "locale"
          },
          "time_zone": "Europe/Istanbul",
          "time_zone_offset": 10800,
          "greeting": null,
          "signature": null,
          "status_message": null,
          "last_seen_user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:146.0) Gecko/20100101 Firefox/146.0",
          "last_seen_ip": "84.40.239.250",
          "last_seen_at": "2025-12-19T14:50:48+00:00",
          "last_active_at": "2025-12-19T14:50:48+00:00",
          "realtime_channel": "presence-9813ca639d37d1518f54b0c65e3b4bef061d5c9eb084715329b7324d129bf437@v1_users_60215103",
          "presence_channel": "user_presence-9813ca639d37d1518f54b0c65e3b4bef061d5c9eb084715329b7324d129bf437@66e9687b5ff32c9c31da30066b58887e988e379c",
          "password_updated_at": "2025-07-23T10:33:22+00:00",
          "avatar_updated_at": null,
          "last_logged_in_at": "2025-12-19T14:50:48+00:00",
          "last_activity_at": "2025-12-19T14:50:48+00:00",
          "created_at": "2018-12-04T11:53:18+00:00",
          "updated_at": "2025-12-19T14:50:48+00:00",
          "resource_type": "user",
          "resource_url": "https://central-supportdesk.kayako.com/api/v1/users/60215103"
        },
        "ticket_idt": 60196166
      },
      "interactions": [
        [
          "2025-12-10T15:48:26Z",
          "GHI Engineering - 15673 // daniel-wachira unassigned"
        ],
        [
          "2025-12-01T00:00:45Z",
          "GHI Engineering - 15673 // trilogy-taro[bot] removed_from_project_v2"
        ],
        [
          "2025-11-30T18:57:23+00:00",
          "Kayako - ticket id 60196166 // Mike Kebede commented publicly: Dear Slawek,\n\nThank you for your patience.\n\nOur Engineering team has completed the fixes for the High Availability issues you reported, including the WAN failover behavior and the license loss on the passive node. Both corrections are now included in the Kerio Control 9.6.0 release branch.\n\nThe fixes will be delivered as part of the official Kerio Control 9.6.0 release. There is no separate beta build available for download at this time. Once 9.6.0 becomes publicly available, you will be able to install it and validate the corrected HA behavior in your environment.\n\nIf you have any further questions in the meantime, feel free to let us know.\n\nBest regards,\nMike Kebede\nGFI - Kerio Control Support Team\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you."
        ],
        [
          "2025-11-30T18:47:54+00:00",
          "Kayako - ticket id 60196166 // Cu Chulainn AI Manager commented privately: ===== Operation Summary =====\n1. Process halted per Step 3. Validation and findings:\n2. - DS for Escalated Issue (only GHI!) field value: https://github.com/trilogy-group/eng-maintenance/issues/15673 \u2192 Parsed issue ID: 15673 (valid URL)\n3. - Queried GHI 15673:\n4. \u2022 Product identified: Kerio Control (label: Product:Kerio Control; body explicitly lists Product: Kerio Control)\n5. \u2022 Issue state: CLOSED (closed_at 2025-11-30 18:37:48Z)\n6. \u2022 Build link: No Google Drive build link found in comments. Latest relevant comment states \u201cThis will be released with Kerio Control 9.6.0.\u201d No Drive folder URL or special update instructions present.\n7. Conclusion: Although the GHI is closed and the Product is identified, there is no new build Google Drive link in GHI comments. As required by the flow, we cannot proceed to share a build with the customer. Stopping here and keeping the ticket OPEN until Engineering provides a build link or official release artifacts. Next step once available: re-run the flow and send the product-specific PR with the Google Drive link.\n===== End of Summary =====\n\nNo PR was sent"
        ],
        [
          "2025-11-30T18:40:50+00:00",
          "Kayako - ticket id 60196166 // Cu Chulainn AI Manager commented privately: <CC Log>\n\nPackage URL: https://cs.cu-chulainn.csaiautomations.com/marketplace/packages/edit/PACKAGE-7f2d168a-c392-4bbe-806b-18829f9db947\nPackage Name: GFIGHIBetaBuildsHandler\n\nCu Chulainn has been initiated for this ticket. AI conversation logs can be found in the following location: [https://us-east-1.console.aws.amazon.com/s3/object/cu-chulainn-files?region=us-east-1&bucketType=general&prefix=agent-conversation-logs/environment%3Dcs/partition_id%3Dkayako_central-supportdesk_60196166/kayako_central-supportdesk_60196166_20251130_184050_2f1a.txt]\n\n</CC Log>\n"
        ],
        [
          "2025-11-30T18:38:37Z",
          "GHI Engineering - 15673 // trilogy-taro[bot] commented: > #taro-issue-summary\n\nThe customer experiences a defect where the passive node in a High Availability setup loses its license and becomes locked on the license activation screen after HA is enabled in Kerio Control 9.6.0 beta, making the WebAdmin interface inaccessible and preventing normal HA operation. The root cause is that the customer uses a trial license which contains machine-locked TrialKey and TrialData information that cannot be synchronized between appliances due to hardware binding, causing activation failures when HA attempts to sync this data to the passive node. The Engineering team has implemented a fix that removes the machine-locked trial license information from HA synchronization, and this fix is included in Kerio Control 9.6.0 RC and will be released with the final 9.6.0 version.\n\n\n> Created with [Taro](https://github.com/trilogy-group/taro/tree/shell). Like this comment if it was helpful.\n"
        ],
        [
          "2025-11-30T18:37:50Z",
          "GHI Engineering - 15673 // github-project-automation[bot] project_v2_item_status_changed"
        ],
        [
          "2025-11-30T18:37:48Z",
          "GHI Engineering - 15673 // anujkumar-df commented: This will be released with Kerio Control 9.6.0."
        ],
        [
          "2025-11-26T12:20:00Z",
          "GHI Engineering - 15673 // daniel-wachira commented: The fix is now included in Control 9.6.0 RC branch."
        ],
        [
          "2025-11-24T14:52:38Z",
          "GHI Engineering - 15673 // daniel-wachira commented: PR: https://github.com/trilogy-group/kerio-winroute-winroute/pull/1537\n\nRC build artifacts will be made available once the fix is verified and built."
        ],
        [
          "2025-11-24T14:48:45Z",
          "GHI Engineering - 15673 // daniel-wachira parent_issue_added"
        ],
        [
          "2025-11-24T14:40:11Z",
          "GHI Engineering - 15673 // daniel-wachira commented: ### Findings & RCA\nI upgraded both to 9.6.0-9121 (current RC) and shut down both machines. After rebooting the HA is now stable, no issues.\nI now understand the issue - it is indeed a defect.\nIn Control 9.6.0 trial licenses are machine-locked to the device. This customer is using a trial license which is not clearly conveyed in the description. I checked kayako and the user did in fact post his winroute.cfg and we can see the issue clearly:\n\n```xml\n<table name=\"License\">\n  <variable name=\"TrialId\">20339-4D578-9148Q</variable>\n  <variable name=\"TrialKey\">0074f9f0f1c882577af72dc5b8ed546f56d08a9450af96e0e027a327ba2e9f08</variable>\n  <variable name=\"TrialData\">2fed6548c57c54844fae95f8972cf7124be7e429dbf7c976528c1c918a37f10b</variable>\n  <variable name=\"UnregisteredTrial\">0</variable>\n</table>\n```\n\nThe TrialKey and TrialData information can never be synchronized between appliances. It will cause the activation failure because of the hardware lock.\n\n### Next Step\nWe need to remove the machine-locked information from the HA synchronization. This will fix the problem."
        ],
        [
          "2025-11-22T13:37:20Z",
          "GHI Engineering - 15673 // daniel-wachira commented: Ok, I am experiencing a regression in HA where the link state is very unstable. It synchronizes fine but then constantly drops the link. The status changes from ok to 'health check failed' constantly, making real testing difficult. This seems to be an issue with master since when master is down, slave behaves normally.\nHowever, this doesn't explain the license issue the customer reported. "
        ],
        [
          "2025-11-22T12:19:02Z",
          "GHI Engineering - 15673 // daniel-wachira commented: > Attempt online activation and activation via license file \u2192 both fail\n\nThis is because the slave always has it's WAN interfaces turned off. It cannot communicate with the internet. This is by design and not a regression.\n\nI am able to access webadmin on both devices but that was from an upgrade. I'll retest with completely clean install, no config backup import."
        ],
        [
          "2025-11-22T11:17:26Z",
          "GHI Engineering - 15673 // daniel-wachira project_v2_item_status_changed"
        ],
        [
          "2025-11-22T10:37:27Z",
          "GHI Engineering - 15673 // daniel-wachira commented: Control 9.6 completely dropped support for unregistered trial licenses, that could be the culprit here."
        ],
        [
          "2025-11-22T10:35:46Z",
          "GHI Engineering - 15673 // daniel-wachira assigned to daniel-wachira"
        ],
        [
          "2025-11-20T16:39:07Z",
          "GHI Engineering - 15673 // trilogy-taro[bot] commented: # Engineering Issue Bot\n\n## Issue Reproduction\nI analyzed the provided debug logs and Kayako ticket ka#60196166. The issue manifests as follows:\n\n**Key Observations from Logs:**\n- **Passive Node (debug_PASSIVE.txt)**: Multiple entries showing `{licensing} Host allowed, license size: 0` indicating the license file is empty/missing\n- **Active Node (debug_ACTIVE.log)**: Shows normal HA sync process at 14:29-14:31 with \"License changed\" entries appearing after HA initiation\n- **Timing**: License loss occurs immediately after HA configuration sync completes, with no failover required to trigger the issue\n\n**Reproduction Steps Confirmed:**\n1. Install Kerio Control 9.6.0 beta (build 9058) on two clean VMs\n2. Configure network interfaces and enter same license key on both nodes\n3. Enable HA on first node (Master), join second node as Slave\n4. Allow HA to stabilize\n5. **Observed**: Passive node immediately loses license and displays only license activation screen in WebAdmin\n\n## Root Cause Analysis\nAfter examining the codebase (repository: trilogy-group/kerio-winroute-winroute, branch: develop-control), I identified the root cause:\n\n**Code-Level Analysis:**\n- **File: winroute/src/Backup.cpp**\n  - The `createExportFile()` function creates the backup archive for HA sync (lines 133-218)\n  - Archive includes: winroute.cfg, UserDB.cfg, logs.cfg, host.cfg, certificates, DHCP leases\n  - **Missing**: `license.key` file from `gdata.ansiLicense_dir` directory\n\n- **File: libwebadmin/src/HighAvailabilityDispatcher.cpp**\n  - The `doMergeCerts()` function (lines 390-422) handles file-based resources (certificates)\n  - No handling for license.key file restoration on Slave\n\n- **File: libwebadmin/src/HighAvailabilityDispatcher.cpp (initMergeConfig)**\n  - Preserves TinyDB variables: `License.TrialId` and `License.UnregisteredTrial`\n  - BUT: These are just trial-related variables, not the full license key\n\n**Why This Causes the Issue:**\nThe HA sync preserves some license-related TinyDB configuration variables but does NOT sync the actual `license.key` file that contains the full license information. When the Passive node receives the synced config without the license file, the licensing system reports \"license size: 0\" and locks the WebAdmin to the license activation screen.\n\n**Regression Context:**\nThis issue was discovered while validating the fix for #14502 (WAN failover configuration sync). The fix from PR #1519 successfully addressed WAN link configuration but did not include license file sync, revealing this separate regression.\n\n## Test Plan\n**Unit Tests:** Not applicable - this involves file operations and HA sync which require integration testing\n\n**Integration Tests:**\n1. Set up two Kerio Control 9.6.0 instances with valid licenses\n2. Configure HA with Master and Slave roles\n3. Enable HA and wait for sync to complete\n4. Verify both nodes maintain valid license state (check logs for \"license size\")\n5. Verify WebAdmin remains accessible on Passive node\n6. Test license activation functionality on Passive (should not be needed)\n\n**E2E Tests:**\n1. Perform full HA setup from scratch with the fix\n2. Trigger multiple config syncs to ensure license file remains synchronized\n3. Manually disable HA (HaMode=0) and verify Passive retains license\n4. Test with different license types (trial, full, expired)\n\n**Impact Analysis:**\n- **Blast Radius**: Low - only affects HA configuration sync\n- **Affected Modules**: Backup/restore, HA synchronization\n- **Dependencies**: None - standalone fix\n- **Feature Impact**: Enables proper HA functionality with license preservation\n\n## Fix Implementation\n**Code Changes:**\n\n1. **winroute/src/Backup.cpp (lines 171-175):**\n```cpp\n// license.key - Include license file for HA synchronization\nstd::string licenseFilePath = std::string(gdata.ansiLicense_dir) + \"/\" + LICENSE_FILE_NAME;\nif (utl::fileExists(licenseFilePath.c_str(), true)) {\n    ret = ar.addToArchiveDir(licenseFilePath, gdata.ansiMainDir) == arch::AR_FINISHED;\n}\n```\nAdded license.key file to the backup archive using the same pattern as certificates.\n\n2. **libwebadmin/src/HighAvailabilityDispatcher.cpp (lines 419-437):**\n```cpp\n// Handle license.key file synchronization\nstd::string receivedLicenseFile = std::string(unpackedDirectory) + \"/license/\" + LICENSE_FILE_NAME;\nif (boost::filesystem::exists(receivedLicenseFile)) {\n    std::string localLicenseFile = std::string(gdata.ansiLicense_dir) + \"/\" + LICENSE_FILE_NAME;\n    std::string commandToExecute;\n    if (boost::filesystem::exists(localLicenseFile)) {\n        commandToExecute += (boost::format(\"rm %s; \") % localLicenseFile.c_str()).str();\n    }\n    commandToExecute += (boost::format(\"mv %s %s\") % receivedLicenseFile.c_str() % localLicenseFile.c_str()).str();\n\n    int retCode = system(commandToExecute.c_str());\n    if (retCode) {\n        isThereFailure = true;\n        logerr(error_module, 0, \"Save peer license file failed. Code %d for command: %s\", WEXITSTATUS(retCode), commandToExecute.c_str());\n    } else {\n        logdbg(le_havailability, \"Peer license file saved successfully\");\n    }\n}\n```\nAdded license.key restoration on Slave node during config merge.\n\n**Design Decisions:**\n- Followed existing certificate sync pattern (proven to work reliably)\n- Minimal code changes to reduce regression risk\n- Preserves repository coding style and conventions\n- Includes appropriate logging for troubleshooting\n\n## Test Results\n**Build Status:** \u26a0\ufe0f Build environment requires Debian Jessie (not available in current environment)\n\n**Code Review:** \u2705 Passed\n- Changes follow existing patterns from certificate sync\n- Minimal code modifications (27 lines added across 2 files)\n- Proper error handling and logging included\n- No modifications to existing functionality\n\n**Static Analysis:** \u2705 Passed\n- Uses existing utilities (boost::filesystem, system commands)\n- Follows same pattern as certificate handling (proven stable)\n- Appropriate null checks and error handling\n\n## Deliverables\n\u2705 **Pull Request Created:** https://github.com/trilogy-group/kerio-winroute-winroute/pull/1535\n- Branch: `issue-bot/fix-ha-license-15673`\n- Base: `develop-control`\n- Status: Draft (awaiting review and build verification)\n\n**Code Changes Summary:**\n- **Files Modified**: 2\n  - `winroute/src/Backup.cpp`: +5 lines (adds license.key to backup archive)\n  - `libwebadmin/src/HighAvailabilityDispatcher.cpp`: +22 lines (adds license.key restoration)\n- **Total Impact**: 27 lines added, 0 lines removed\n- **Complexity**: Low (follows existing patterns)\n\n**Next Steps for Resolution:**\n1. \u2705 Code review by Kerio Control maintainers\n2. \u23f3 Build and unit test execution on Debian Jessie environment\n3. \u23f3 Integration testing on HA setup with license validation\n4. \u23f3 QA verification on beta build with fix\n5. \u23f3 Release planning for 9.6.0 or 9.6.1\n\n## Confidence Assessment\n**Likelihood of Fix Correctness: 95%**\n\n**Reasoning:**\n- Root cause clearly identified through log analysis and code review\n- Fix directly addresses the missing license.key file sync\n- Implementation follows proven pattern from certificate sync (stable since HA feature introduction)\n- Minimal code changes reduce regression risk\n- Logs from the issue show exact symptoms matching the root cause\n\n**Remaining Uncertainty (5%):**\n- Actual build and integration testing not performed due to environment limitations\n- Customer should validate with beta build containing this fix\n\n## Alternative Solutions Considered\n1. **Sync via TinyDB instead of file**: \u274c Rejected\n   - License data may be binary and not suitable for TinyDB\n   - Existing license manager expects file-based license.key\n   - Would require significant refactoring\n\n2. **Preserve Slave's original license**: \u274c Rejected\n   - Documentation states \"license keys should be the same on both Master and Slave\"\n   - Would violate HA design principle of identical configuration\n\n3. **Skip license sync entirely**: \u274c Rejected\n   - Would require manual license management on Slave\n   - Defeats purpose of automated HA configuration sync\n\n**Conclusion:** The implemented solution (sync license.key file) is the most appropriate and lowest-risk approach."
        ],
        [
          "2025-11-20T16:27:44+00:00",
          "Kayako - ticket id 60196166 // Centralsupport-ai-acc commented privately: Placing on hold for 9999 hour(s)"
        ],
        [
          "2025-11-20T16:27:04+00:00",
          "Kayako - ticket id 60196166 // Mike Kebede commented publicly: Dear Slawek,\n\nThank you for your detailed description and for sending the new logs, configurations, and the screen recording.\n\nThe behavior you describe on the 9.6.0 beta build \u2013 where the passive device loses its license immediately after enabling HA and remains stuck on the activation screen even after disabling HA \u2013 is not expected and is not caused by your configuration. It is a separate issue from the original Primary/Backup flag problem.\n\nWe are now formally escalating this new behavior to our Engineering team as a follow-up to the original HA defect. At this stage:\n\n\t*\nWe do not need any further tests from your side.\n\n\t*\nWe will use the logs and information you have already provided to investigate the licensing/WebAdmin issue on the passive node.\n\n\t*\nWe will update you as soon as Engineering provides a corrected build or clear guidance.\n\nIn the meantime, we cannot recommend using HA together with Multiple Internet Links \u2013 Failover in production on the affected versions.\n\nThank you again for your patience and for the thorough work you have already done to help us pinpoint the problem.\n\nBest regards,\nMike Kebede\nGFI \u2013 Kerio Control Support Team\n"
        ],
        [
          "2025-11-20T16:24:56Z",
          "GHI Engineering - 15673 // github-project-automation[bot] project_v2_item_status_changed"
        ],
        [
          "2025-11-20T16:24:54Z",
          "GHI Engineering - 15673 // trilogy-eng-standards added_to_project_v2"
        ],
        [
          "2025-11-20T16:24:48Z",
          "GHI Engineering - 15673 // trilogy-taro[bot] labeled as Product:Kerio Control"
        ],
        [
          "2025-11-20T16:24:46+00:00",
          "Kayako - ticket id 60196166 // CE Maintenance Bot commented privately: Opened engineering issue https://github.com/trilogy-group/eng-maintenance/issues/15673"
        ],
        [
          "2025-11-20T16:24:27Z",
          "GHI Engineering - 15673 // mike-kebede labeled as Eng-Maintenance"
        ],
        [
          "2025-11-20T15:36:48+00:00",
          "Kayako - ticket id 60196166 // Ciprian Nastase commented privately:  Reopening per Aditi's request \n We should've reviewed and clarified whatever was weird for the customer "
        ],
        [
          "2025-11-19T12:23:35+00:00",
          "Kayako - ticket id 60196166 // Jan Paraniak commented privately: What is your proposed action?\n\nSend to customer (just apply the macro)\n\nor close\n\nAdditional Context:\n\nWas reviewing the ticket, seems like the customer's last question was answered (they were right), and Hermes sent a PR\n"
        ],
        [
          "2025-11-19T07:21:00+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello,\n\u00a0\nI don't understand what response you are expecting from me.\n\u00a0\nI have nothing else to test right now.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: KerioControl (customersupport-keriocontrol@gfi.com)\nData: 19-11-2025 00:34\nDo: slawek@suncapital.pl\nTemat: Reminder: Please reply to ticket #60196166 \u2014 HA Configuration Issue: Missing Flags on Slave Device\n\nHello Slawomir,\n\nWe're awaiting your response regarding ticket #60196166 \u2014 \u201cHA Configuration Issue: Missing Flags on Slave Device.\u201d To continue the conversation, reply to this email or via the following Help Center link to the case:\nhttps://support.keriocontrol.gfi.com/conversation/view/60196166\n\nLatest ticket message:\n\nIf we don't hear from you, we'll automatically close the ticket in about 7 days after our last message due to inactivity. If that occurs, you can continue the conversation by creating a new ticket in the Help Center referencing ticket #60196166; we'll pick up where we left off.\n\nBest regards,\nGFI - Kerio Control Support Team\n\nThis is a KerioControl message delivered by Kayako [https://kayako.com].\n\nimage \n"
        ],
        [
          "2025-11-17T22:51:49+00:00",
          "Kayako - ticket id 60196166 // Centralsupport-ai-acc commented privately: Hour Offset is Empty, opening"
        ],
        [
          "2025-11-17T22:50:53+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented publicly: Dear Slawomir,\n\nThank you for your follow-up and for clarifying your HA test setup using a brand-new Kerio Control virtual device and the latest BETA version ISO image. I also appreciate your question regarding license configuration in High Availability (HA) deployments.\n\nKerio Control HA Licensing: Expected Behavior\n\nIn Kerio Control\u2019s High Availability configuration, both devices\u2014the Master and the Slave (passive)\u2014must use the same license key. This is explicitly required for proper HA operation and is confirmed in multiple sections of the product documentation and official configuration guides. You should not enter different license numbers on each appliance; the system is designed to function as a synchronized pair, sharing the same configuration, including the license key. This is consistent with your experience and best practice.\n\nDuring HA establishment:\n\n \t* Enter your valid license key on the Master device.\n \t* When joining the Slave node, the license should be synchronized, and both devices should reflect the same license information.\n \t* The Slave should not require a separate activation (beyond what is automatically synchronized from the Master).\n\nIf you are still seeing a license request prompt on the passive device (even after configuring HA with a fresh install and using identical license keys), this is not the intended behavior and may represent a regression or unresolved issue in the BETA release. Based on your feedback, this licensing issue is occurring even after a clean setup, and is blocking access to the Web Administration interface on the passive node.\n\nFile observations and confirmation of tested setup:\n\n \t* Your logs and configuration files confirm that the test was done on a new virtual machine, using the BETA ISO, and that the HA join/licensing process was followed as expected.\n \t* The persistent license prompt and loss of WebAdmin access on the passive device after enabling HA are not caused by an incorrect license entry or mismatch, especially given that you entered the same license number as recommended and required.\n\nSummary and Recommendations:\n\n \t* Both Master and Slave appliances in HA mode must use the same license key. This is the correct and expected approach; no separate (unique) licenses are needed or supported.\n \t* Your process\u2014using the same license for both\u2014matches Kerio Control's documented requirements and product behavior.\n \t* The issue you are experiencing (licensing state loss and WebAdmin inaccessibility on the passive device) is not in line with intended product design and persists even after following best practices. It is not a configuration error on your part.\n \t* Your diligence in setting up a clean test environment and documenting both the HA flag transfer and the new licensing problem has been very helpful for ongoing troubleshooting.\n\nIf you have further technical questions regarding HA configuration or need clarification on any steps, please let me know. Your case feedback is valuable for improving product reliability and documentation for all customers using Kerio Control in HA scenarios.\nSincerely,\nAtlas\nGFI - Kerio Control Support Team."
        ],
        [
          "2025-11-14T08:17:26+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello,\n\nThank you for your reply.\n\u00a0\nIt was a completely new virtual device, set up from scratch using a BETA version ISO image. I wrote about this earlier\u2014my previous devices would not update using the BETA version upgrade image, so I had to set them up again.\n\u00a0\nI have a question\u2014why do you say that both appliances should have license numbers entered? Shouldn't it be the case in a HA that both devices should have the same license number set, because that's how I tested it myself.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: KerioControl (customersupport-keriocontrol@gfi.com)\nData: 10-11-2025 05:34\nDo: slawek@suncapital.pl\nTemat: Reminder: Please reply to ticket #60196166 \u2014 HA Configuration Issue: Missing Flags on Slave Device\n\nHello Slawomir,\n\nWe're awaiting your response regarding ticket #60196166 \u2014 \u201cHA Configuration Issue: Missing Flags on Slave Device.\u201d To continue the conversation, reply to this email or via the following Help Center link to the case:\nhttps://support.keriocontrol.gfi.com/conversation/view/60196166\n\nLatest ticket message:\n\nIf we don't hear from you, we'll automatically close the ticket in about 7 days after our last message due to inactivity. If that occurs, you can continue the conversation by creating a new ticket in the Help Center referencing ticket #60196166; we'll pick up where we left off.\n\nBest regards,\nGFI - Kerio Control Support Team\n\nThis is a KerioControl message delivered by Kayako [https://kayako.com].\n\nimage \n"
        ],
        [
          "2025-11-09T04:14:41+00:00",
          "Kayako - ticket id 60196166 // Carlos Encalada commented publicly: Dear Slawek,\n\nThank you for your detailed update and for taking the time to test the beta version in your environment. I understand your concerns regarding both the Primary/Backup link flag behavior and, now, the loss of license and administrative access on the passive device after establishing High Availability (HA).\n\nBased on your report and the logs you've provided, it appears that while the transfer of Primary/Backup WAN link flags in HA mode has improved in the new build, there are now new issues related to licensing and access on the passive node. This is clearly not the expected or documented behavior, and it\u2019s critical that both units remain manageable and retain their license state in HA deployments.\n\nTo ensure we clear any residual configuration or legacy data that may be affecting HA synchronization\u2014especially after multiple upgrade paths or manual edits\u2014we strongly recommend that you perform a factory reset the test appliance. Once completed, please flash the device with the latest beta patch image provided by our Engineering team, and proceed to reconfigure HA from scratch, ensuring both license keys are entered and all interface names match exactly. This \u201cclean slate\u201d approach helps rule out any configuration file corruption or compatibility issues from previous builds or test cycles.\n\nAfter completing the factory reset and patch install, please re-test the HA failover and let us know if:\n\n\t* The Primary/Backup flags now persist correctly across HA sync and failover events.\n\t* Both nodes maintain license state and remain accessible via the Web Administration interface, especially the previously passive device.\n\nIf the issue is still reproducible after a full reset and patching with the beta build, please let us know immediately and share any updated logs or observations. We will escalate this directly with Engineering for further analysis.\n\nBest regards,\nCarlos Encalada\nGFI - Kerio Control Support Team\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you."
        ],
        [
          "2025-11-09T04:04:26+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented privately: :: FILE ANALYSIS RESULTS ::\n\n \t\tFILE\n \t\tOBSERVATIONS\n\n \t\t2025-10-06_10-31-50.flv_1575334\n\nFile\u00a0analysis\u00a0missing.\n\n \t\tdebug.log_SLAVE.txt_1575335\n \t\tRepeated failures to identify or restore the Primary WAN interface after High Availability (HA) events, resulting in missing Primary/Backup flags and improper failover behavior. This leads to loss of default gateway configuration and potential connectivity outages.\n \t\tMultiple log entries such as [06/Oct/2025 08:21:12], [06/Oct/2025 08:32:18], [06/Oct/2025 08:32:35], [06/Oct/2025 08:33:23], [06/Oct/2025 08:33:38], and [06/Oct/2025 08:36:19] report '{connectivity} Primary interface (id ...) not found, giving up.' This indicates the system cannot find or assign the Primary WAN interface during or after HA failover. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), HA is expected to manage interface states and routes automatically, but there is no documentation that standard Ethernet WAN interfaces should lose their Primary/Backup roles or fail to restore them after failover. This suggests the observed behavior is not expected or documented, and may indicate a product defect or unhandled edge case.\n\n \t\tStatic routes are repeatedly not added due to WAN interfaces preventing their creation after HA synchronization, which directly impacts failover routing and default gateway setup.\n \t\tLog entries such as [06/Oct/2025 08:19:32], [06/Oct/2025 08:20:17], [06/Oct/2025 08:36:10], and [06/Oct/2025 08:36:14] show 'Interface WAN will prevent adding static route.' and 'Interface WAN2 will prevent adding static route.' This results in 'Static route will not be added.' and matches the reported default gateway and failover routing issues. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) explains that in certain cases, Kerio Control will create a static route via the sync interface if no Internet interfaces are available on the slave, but it does not document that standard Ethernet WAN interfaces should prevent static route creation in a healthy HA setup. The repeated prevention of static route creation by WAN interfaces is not expected and aligns with the product issue described.\n\n \t\tRepeated failures in HA peer authentication or state synchronization, indicated by invalid peer tokens and handshake restarts, which may prevent proper role assignment and synchronization between HA nodes.\n \t\tLog entries such as [06/Oct/2025 08:35:15], [06/Oct/2025 08:36:06], and [06/Oct/2025 08:36:10] report '{HighAvailability} Peer token is invalid.' and 'Peer rejected token. Handshake will start again.' These repeated failures suggest problems in HA state transfer or authentication, potentially contributing to the loss of WAN role metadata and failover malfunction. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) notes that HA validation and synchronization should complete automatically and repeatedly attempt validation if there are issues, but does not document persistent peer token failures or their impact on interface role assignment. This indicates an abnormal HA synchronization state that may be contributing to the observed failover issues.\n\n \t\tdebug.log_MASTER.txt_1575336\n \t\tFrequent High Availability (HA) health check and validation failures indicate instability in HA communication, which can disrupt failover and synchronization processes.\n \t\tMultiple log entries show 'Status: No response (Validation failed.)' and 'Status: No response (Health check failed.)' occurring repeatedly between 08:32:06 and 08:36:06 on 06/Oct/2025. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), HA validation failures can occur if there are issues with interface configuration, network connectivity, or mismatched settings between Master and Slave. The article notes that even if validation fails, Kerio Control will continue sending validation data and will complete validation automatically once the underlying issue is resolved.\n\n \t\tRepeated HA subsystem shutdowns and 'Down event occurred' messages suggest the HA system is not maintaining stable operation, potentially leading to loss of WAN interface role metadata and default gateway issues after failover.\n \t\tExample: [06/Oct/2025 08:32:48] {HighAvailability} Down event occurred. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) describes that HA will disable certain interfaces and manage routes dynamically during HA transitions. However, it does not document that standard Ethernet WAN interfaces should lose their Primary/Backup roles or that repeated subsystem shutdowns are expected. Persistent HA subsystem instability may prevent proper synchronization of interface roles and routes.\n\n \t\tPeer token validation failures and rejections are present, indicating problems with the HA handshake and authentication process, which can prevent proper synchronization between HA peers.\n \t\tExamples include '[06/Oct/2025 08:35:15] {HighAvailability} Peer rejected token. Handshake will start again.' and '[06/Oct/2025 08:35:15] {HighAvailability} Status: Failed (Peer token is invalid.)'. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) states that HA validation and synchronization depend on successful communication and matching configuration between peers. Token validation failures can result from mismatched credentials, network issues, or configuration drift, and will prevent successful HA operation until resolved.\n\n \t\tDebug.txt_1600380\n \t\tMultiple failed login attempts detected, indicating possible brute-force attack or unauthorized access attempts.\n \t\tLog entries show repeated authentication failures from the same external IP addresses within short time frames. If these attempts are targeting VPN or web admin interfaces, consider reviewing firewall and VPN access policies as described in Kerio Control documentation. No direct mitigation for brute-force is detailed in the referenced knowledgebase articles, but ensure strong password policies and consider geo-blocking if VPN attempts are from unexpected regions.\n\n \t\tUnexpected firewall rule changes were made outside of standard maintenance windows.\n \t\tSummary log records configuration changes to firewall rules at unusual hours, not matching scheduled change periods. If these changes impact interface or HA configuration, refer to https://support.keriocontrol.gfi.com/article/116379 for details on how HA may auto-create or modify traffic rules (see section 4-Traffic Rules). Unexpected changes should be audited for compliance with documented HA behavior.\n\n \t\tUnusual outbound traffic spikes to unfamiliar external IP addresses.\n \t\tTraffic summary indicates significant data transfer to IP addresses not previously seen in network activity. If these spikes coincide with HA failover or interface changes, review the HA special cases in https://support.keriocontrol.gfi.com/article/116379, especially regarding auto-created routes and traffic rules. Otherwise, investigate for possible compromise or misconfiguration.\n\n \t\tBlocked connections to known malicious domains.\n \t\tLog evidence shows multiple attempts to connect to domains flagged by threat intelligence feeds, which were successfully blocked by Kerio Control. This indicates that security filtering is functioning as expected. No additional action from the knowledgebase is required unless these attempts correlate with HA or interface changes.\n\n \t\tVPN connection attempts from unauthorized geographic locations.\n \t\tSummary log highlights VPN login attempts originating from countries not associated with company operations. This may indicate attempted unauthorized access. While not directly addressed in the referenced HA knowledgebase articles, ensure VPN access policies are restricted and review the Kerio Control traffic rules (see https://support.keriocontrol.gfi.com/article/116379, section 4-Traffic Rules) to limit exposure.\n\n \t\tError_upgrade.png_1600381\n\n-\u00a0During\u00a0an\u00a0attempt\u00a0to\u00a0update\u00a0the\u00a0software\u00a0using\u00a0the\u00a0binary\u00a0image\u00a0file\u00a0update\u00a0method,\u00a0a\u00a0critical\u00a0error\u00a0appeared.\n-\u00a0The\u00a0error\u00a0message\u00a0displayed\u00a0is:\u00a0Nie\u00a0mo\u017cna\u00a0wykona\u0107\u00a0aktualizacji:\u00a0tar:\u00a0Exiting\u00a0with\u00a0failure\u00a0status\u00a0due\u00a0to\u00a0previous\u00a0errors\u00a0(Translation:\u00a0Cannot\u00a0perform\u00a0update:\u00a0tar:\u00a0Exiting\u00a0with\u00a0failure\u00a0status\u00a0due\u00a0to\u00a0previous\u00a0errors).\n-\u00a0The\u00a0error\u00a0message\u00a0appeared\u00a0in\u00a0a\u00a0popup\u00a0window\u00a0titled\u00a0B\u0142\u0105d\u00a0(Error).\n-\u00a0In\u00a0the\u00a0top\u00a0right\u00a0corner\u00a0of\u00a0the\u00a0Kerio\u00a0Control\u00a0interface,\u00a0there\u00a0is\u00a0a\u00a0warning\u00a0stating\u00a0Wygasaj\u0105ca\u00a0licencja\u00a0(Expiring\u00a0license).\n-\u00a0The\u00a0update\u00a0process\u00a0did\u00a0not\u00a0complete,\u00a0which\u00a0may\u00a0have\u00a0prevented\u00a0the\u00a0deployment\u00a0or\u00a0testing\u00a0of\u00a0the\u00a0new\u00a0software\u00a0version\u00a0related\u00a0to\u00a0the\u00a0reported\u00a0HA\u00a0issue.\n\n \t\tError.txt_1600382\n \t\tMultiple failed login attempts detected from a single external IP address, indicating a possible brute-force attack.\n \t\tSummary log shows repeated authentication failures from IP 203.0.113.45 targeting the admin interface within a short time frame.\n\n \t\tUnexpected service restart for the Kerio Control engine outside of scheduled maintenance window.\n \t\tLog entry: 'Kerio Control Engine restarted unexpectedly at 03:17 AM. No maintenance scheduled at this time.'\n\n \t\tBlocked outgoing connection attempts to known malicious IP addresses.\n \t\tSummary log indicates multiple attempts by internal host 192.168.1.25 to connect to blacklisted IP 185.220.101.1, which were blocked by firewall rules.\n\n \t\tUnusual spike in denied VPN connection attempts from foreign countries.\n \t\tLog shows 50+ denied VPN logins from IPs originating in Russia and China within a 10-minute window.\n\n \t\tConfiguration change detected outside of authorized change window.\n \t\tLog entry: 'Firewall rule modified by user 'jdoe' at 02:45 AM. No change request logged for this period.'\n\n \t\tdebug_ACTIVE.log_1602608\n \t\tHigh Availability (HA) process repeatedly disables both WAN interfaces ('WAN' and 'WAN 2') on the slave device during initialization and synchronization, resulting in loss of Primary/Backup flags and default gateway configuration. There is no evidence in the logs of these roles being restored after HA events, directly causing connectivity issues during failover.\n \t\t[03/Nov/2025 14:29:01] {HighAvailability} Disabling 'WAN' automatically from high availability.; [03/Nov/2025 14:29:01] {HighAvailability} Disabling 'WAN 2' automatically from high availability.; No subsequent log entries show restoration of Primary/Backup flags or default gateway configuration. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), Kerio Control is expected to disable certain interface types (such as Wi-Fi and PPPoE) on the slave during HA validation, but there is no documentation stating that standard Ethernet WAN interfaces should lose their Primary/Backup roles or remain disabled after failover. The observed behavior is not documented as expected and may indicate a product defect or an unhandled edge case.\n\n \t\tPersistent HA health check failures and invalid peer token errors indicate ongoing communication or authentication problems between HA nodes, which can disrupt synchronization and failover operations.\n \t\t[03/Nov/2025 14:41:11] {HighAvailability} Peer rejected token. Handshake will start again.; [03/Nov/2025 14:41:19] {HighAvailability} Peer state changed: Failed (Peer token is invalid.); [03/Nov/2025 14:36:07] {HighAvailability} Status: No response (Health check failed.); [03/Nov/2025 15:00:06] onward: repeated 'Status: No response (Health check failed.)'. The knowledgebase (https://support.keriocontrol.gfi.com/article/116379) notes that HA validation and synchronization are required for proper operation, and persistent failures in health checks or peer authentication can prevent correct HA failover and interface state transitions.\n\n \t\tDuring HA failover, the slave device fails to assume the correct virtual IPs, resulting in a critical state where the slave cannot provide network connectivity when the master is down.\n \t\t[03/Nov/2025 14:59:53] Daemon State changed from OK to Failure (Master down, Slave no Virtual IPs); [03/Nov/2025 15:00:19] Detected slave has no virtual IP when master is down. As per the knowledgebase article (https://support.keriocontrol.gfi.com/article/116379), HA is expected to assign virtual IPs to the active node during failover. Failure to do so is not documented as normal behavior and indicates a malfunction in the HA process.\n\n \t\tUnexpected license state changes are logged during HA events, which may indicate licensing synchronization issues between master and slave devices, potentially affecting service continuity.\n \t\t[03/Nov/2025 14:38:02] License changed. The knowledgebase does not specifically address license synchronization in HA scenarios, but loss of license on the passive device after HA establishment (as reported by the customer) is not expected and may further disrupt HA operations and access to the Web Administration interface.\n\n \t\twinroute_ACTIVE.cfg_1602609\n\nFile\u00a0analysis\u00a0missing.\n\n \t\tkerio_support_info_ACTIVE.txt_1602610\n \t\tHigh Availability (HA) synchronization completes, but WAN Primary/Backup flags are not preserved after HA establishment or failover.\n \t\tThe debug log shows extensive HA data merges and config syncs (e.g., '[03/Nov/2025 14:05:52] {HighAvailability} High Availability dispatcher merge ...'), but there is no evidence of WAN link role (Primary/Backup) assignment or restoration after HA events. The support file and customer context confirm that after HA is established, the passive device loses the Primary/Backup flags on its WAN interfaces, which is not expected. This is a core defect as it breaks failover routing logic and is reproducible in both virtual and hardware environments. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), HA is expected to manage interface states and routes automatically, but there is no documentation that standard Ethernet WAN interfaces should lose their Primary/Backup roles or that this metadata should be omitted during HA failover. Therefore, this behavior is not documented as normal or expected and likely represents a product defect.\n\n \t\tThe passive device loses its license after HA is established, making WebAdmin inaccessible and preventing activation.\n \t\tThe customer reports, and the support info confirms, that after HA is activated (even without role switch), the passive device requests license activation and cannot be accessed via WebAdmin. This is a regression in 9.6.0 build 9058, as the passive node should retain its license state and remain manageable. This blocks further troubleshooting and renders the HA setup unusable in production. There is no documentation in the knowledgebase articles reviewed that describes or justifies this behavior; the passive device should remain accessible and licensed in a healthy HA configuration.\n\n \t\tPersistent DNS query and product update failures are present.\n \t\tThe error log contains repeated entries such as '(101) Failed to send DNS query to server 192.168.9.89' and 'Product update failed. Error: Check failed (reminders not set or server error!)'. These failures are likely a consequence of the HA/role issue, as the device may not have a valid default gateway or active WAN interface in the expected state. This impacts the ability to update antivirus and other product components. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) explains that when the slave has no active Internet interfaces, a static route is created to allow updates via the sync interface. However, in this case, the expected failover behavior is not occurring, which is consistent with the observed connectivity loss.\n\n \t\tAntivirus update failures (HttpError404) are frequent.\n \t\tThe error log is filled with 'Unable to fetch updates: HttpError404 (-2112)' for the Antivirus Server. This is likely related to the DNS/gateway issue above, but also indicates that the system is unable to maintain up-to-date security signatures, reducing protection. This is a downstream effect of the HA failover and WAN role issue, as described above.\n\n \t\tSystem is running with less than the recommended RAM for optimal IPS performance.\n \t\tThe warning log repeatedly states 'RAM size is 1995MB. For better IPS performance, please, consider expansion to at least 2096MB.' While not critical for HA, this may degrade Intrusion Prevention System (IPS) throughput and stability, especially under load. This is a general system recommendation and not related to HA configuration per the knowledgebase.\n\n \t\tRoot filesystem is critically low on space (91% used, 88MB free).\n \t\tdf -h shows '/dev/sda2' (/) at 91% usage. While /var has ample space, the root partition being nearly full can cause issues with logging, updates, or temporary file creation, especially during upgrades or heavy logging. This should be monitored and addressed. No direct knowledgebase reference, but this is a standard system health concern.\n\n \t\tNo evidence of file descriptor leaks or abnormal open files/sockets.\n \t\tThe netstat and UNIX socket outputs show a normal number of open files and sockets for a Kerio Control system of this size. There are no excessive or abnormal entries that would indicate a backend resource leak.\n\n \t\tSystem resource usage (CPU, memory, swap) is healthy and not under stress.\n \t\ttop, free, and /proc/meminfo outputs show low CPU usage, over 1GB free RAM, and no swap usage. The main Kerio process (winroute) is using 7.6% of RAM, which is expected. There are no signs of resource exhaustion or performance bottlenecks at the time of the support info capture.\n\n \t\tAll network interfaces are up and detected; link speed/duplex is unknown due to virtualization.\n \t\tifconfig -a and ethstatus show all interfaces (eth0-eth3, kvnet) as UP with link detected. Speed and duplex are 'Unknown', which is typical for Virtio interfaces in QEMU/KVM environments and does not indicate a problem.\n\n \t\twinroute_PASSIVE.cfg_1602611\n\nFile\u00a0analysis\u00a0missing.\n\n \t\t2025-11-03_14-28-01.flv_1602612\n\nFile\u00a0analysis\u00a0missing.\n\n \t\tdebug_PASSIVE.txt_1602613\n \t\tRepeated High Availability (HA) validation failures and peer token errors during HA establishment, indicating synchronization/authentication problems between HA nodes. This likely causes HA malfunction, including loss of license and admin access on the passive device.\n \t\tMultiple log entries show 'Status: No response (Validation failed.)' and 'Peer token is invalid.' Examples: [03/Nov/2025 14:28:42] {HighAvailability} Status: No response (Validation failed.), [03/Nov/2025 14:28:48] {HighAvailability} Status: No response (Validation failed.), [03/Nov/2025 13:41:09] {HighAvailability} Peer token is invalid., [03/Nov/2025 13:41:10] {HighAvailability} Peer token is invalid. These repeated failures indicate HA cluster synchronization/authentication issues. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), HA validation problems can prevent proper synchronization between nodes, and the system will continue to attempt validation until the issue is resolved. If the problem is related to interface name mismatches or legacy defects, refer to article 'HA validation fails with error Interface names are not matching' (https://support.keriocontrol.gfi.com/article/116306), which describes a legacy defect where interface name mismatches (including hidden interfaces like Dial-in) can cause persistent HA validation failures even if the web UI shows identical interfaces. The solution involves renaming the Dial-in interface via SSH and resyncing HA devices.\n\n"
        ],
        [
          "2025-11-03T14:28:23+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello Team,\n\nI have just tested the new version of Kerio Control and unfortunately, the HighAvailability configuration still does not work properly. The Primary/Backup Link flags are transferred within HA, but after activating the HA configuration (even without switching device roles), the Passive device loses its license and cannot be activated in any way \u2014 neither through online activation nor with a license file. What's more, after disconnecting the HA configuration (manual change in the configuration - /opt/kerio/winroute/tinydbclient \"update HaConfig set HaMode=0\"), the Passive device continues to display a request to activate the license and it is not possible to go to Web Administration.\n\u00a0\nSince I cannot access the passive device console because I am repeatedly asked to enter the license, I am unable to check if it works properly after switching.\n\u00a0\nDo you also experience this problem in your test environment?\n\u00a0\nPlease find attached the logs, configurations, and support_info file from the active device. The WebAdmin interface of the passive device is inaccessible after establishing HA, so I cannot generate a support_info file there. Also attached is a short screen capture video of my attempt.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n\n-------------------------\n\nOd: Hermes (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 31-10-2025 17:26\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\n You are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update: \n\n Dear Slawek,\n\nThank you for your update and for letting us know about the difficulties you are experiencing with updating your test machines. We understand that setting up the test environment may take some additional time.\n\nWe will extend the ticket autoclose for 7 days to allow you more time for testing. Please feel free to share your feedback or reach out if you have any questions or encounter any further issues.\n\nSincerely, \nHermes \nGFI - Kerio Control Support Team \n\u00a0 \n\n Sent with Kayako [https://kayako.com] image \n"
        ],
        [
          "2025-10-31T13:10:11+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello Team,\n\nI am having trouble updating my test machines to the 9.6.0 beta version.\n\u00a0\nI will try setting up the test environment again, but it will take some time.\n\u00a0\nI will let you know what I think of the fix once I have tested the new version.\n\nRegards.\nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Linked-In [https://www.linkedin.com/in/slawomir-burak/]\nSun Capital sp. z o.o.\nPOLAND\n\nimage\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n\n-------------------------\n\nOd: Hermes (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 30-10-2025 16:55\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\n You are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update: \n\n Dear Slawek,\n\nThank you for your update. We appreciate you letting us know that you will be testing the beta version and look forward to hearing your feedback.\n\nIf you have any questions or encounter any issues during your testing, please feel free to reach out.\n\nSincerely, \nHermes \nGFI - Kerio Control Support Team \n\n Sent with Kayako [https://kayako.com] image \n"
        ],
        [
          "2025-10-30T12:54:45+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: \u200bHello.\n\nThank you for the information. I'll test the beta version tomorrow and let you know how it goes.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n\n-------------------------\n\nOd: Aditi Garg (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 30-10-2025 12:45\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\n You are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update: \n\nDear Slawek,\n\nOur Engineering team has implemented a fix for the issue you reported. We\u2019ve prepared a beta build for you to evaluate and confirm that the problem has been resolved.\n\nYou can download the beta build from the following link: \ud83d\udd17 Beta Build \u2013 Google Drive Folder [https://drive.google.com/drive/folders/1qUevlxSalsNsiA80BO6ObN7Xgr8HLgUJ?usp=drive_link]\n\nPlease install the build, test it in your environment, and let us know if the issue is resolved or if you encounter any further difficulties.\n\nBest regards, \nAditi Garg \nGFI - Kerio Control Support Team \n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you. \n\n Sent with Kayako [https://kayako.com] image \n"
        ],
        [
          "2025-10-30T11:45:06+00:00",
          "Kayako - ticket id 60196166 // Aditi Garg commented publicly: Dear Slawek,\n\nOur Engineering team has implemented a fix for the issue you reported. We\u2019ve prepared a beta build for you to evaluate and confirm that the problem has been resolved.\n\nYou can download the beta build from the following link: \ud83d\udd17 Beta Build \u2013 Google Drive Folder [https://drive.google.com/drive/folders/1qUevlxSalsNsiA80BO6ObN7Xgr8HLgUJ?usp=drive_link]\n\nPlease install the build, test it in your environment, and let us know if the issue is resolved or if you encounter any further difficulties.\n\nBest regards,\nAditi Garg\nGFI - Kerio Control Support Team\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you."
        ],
        [
          "2025-10-27T11:26:23+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello,\n\u00a0\nCould you please let me know if there has been any progress on my case? The customer has been waiting for a solution for almost two months.\n\u00a0\nThank you.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n\n-------------------------\n\nOd: Mike Kebede (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 13-10-2025 13:23\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\n You are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update: \n\nDear Slawek, \n\nThank you for your feedback. \n\nWe acknowledge that the suggested workaround is not feasible in your environment. Engineering is now actively working on a permanent fix. \n\nWe appreciate your patience and will inform you as soon as a solution becomes available. \n\nBest regards,\nGFI - Kerio Control Support Team \n\n Sent with Kayako [https://kayako.com] image \n"
        ],
        [
          "2025-10-13T11:24:15+00:00",
          "Kayako - ticket id 60196166 // Centralsupport-ai-acc commented privately: Placing on hold for 9999 hour(s)"
        ],
        [
          "2025-10-13T11:23:52+00:00",
          "Kayako - ticket id 60196166 // Mike Kebede commented publicly: Dear Slawek,\n\nThank you for your feedback.\n\nWe acknowledge that the suggested workaround is not feasible in your environment. Engineering is now actively working on a permanent fix.\n\nWe appreciate your patience and will inform you as soon as a solution becomes available.\n\nBest regards,\nGFI - Kerio Control Support Team"
        ],
        [
          "2025-10-06T09:13:47+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello,\n\nThe proposed solution is impossible to set up. I do not have the /etc/opt/kerio/winroute/kr.conf file. There is also no kr.conf file in /opt/kerio/winroute.\n\nThe article https://support.keriocontrol.gfi.com/article/116350-disabling-ha-configuration-for-internet-interfaces describes how to block the disabling of WAN links in HA. However, I am not sure if that is what I am looking for. After blocking this disabling mechanism, will there be an IP conflict because both devices will have the same WAN link addresses and the links will be active on both devices?\n\nFurthermore, after setting the DisableInternetInterfaces=0 parameter according to the KB article, HA establishment causes the Primary/Backup flags to not always be retained. Sometimes they remain and sometimes they disappear, even though the interfaces on the slave device are still active.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n\n-------------------------\n\nOd: Carlos Encalada (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 02-10-2025 17:49\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\n You are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update: \n\nDear Slawek, \n\nThank you for your patience while we reviewed the High Availability (HA) behavior you reported. After analyzing your setup, we have confirmed that this case requires further investigation by our Engineering team. We have escalated the matter accordingly. \n\nIn the meantime, there is a possible interim workaround that may help stabilize HA failover until a permanent fix is released. This change prevents the standby appliance from disabling its Internet interfaces, which can allow proper failover behavior when the Slave takes over. \n\nWorkaround steps (apply on both Master and Slave appliances): \n\n \t* Connect to the appliance via SSH using the root account.\n \t* Edit the file /etc/opt/kerio/winroute/kr.conf\n \t* Add this line at the end of the file: DisableInternetInterfaces=0\n \t* Save the file.\n \t* Restart the Kerio Control service with: /etc/init.d/kerio-control restart\n\nImportant notes: \n\n \t* This is an interim workaround and not part of the standard documented configuration.\n \t* Please test this change in your environment before applying to production.\n \t* We will update you as soon as Engineering provides confirmation and guidance on a permanent resolution.\n\nBest regards,\nGFI - Kerio Control Support Team \n\n Sent with Kayako [https://kayako.com] image \n"
        ],
        [
          "2025-10-02T15:49:36+00:00",
          "Kayako - ticket id 60196166 // Centralsupport-ai-acc commented privately: Placing on hold for 9999 hour(s)"
        ],
        [
          "2025-10-02T15:49:30+00:00",
          "Kayako - ticket id 60196166 // Carlos Encalada commented publicly: Dear Slawek,\n\nThank you for your patience while we reviewed the High Availability (HA) behavior you reported. After analyzing your setup, we have confirmed that this case requires further investigation by our Engineering team. We have escalated the matter accordingly.\n\nIn the meantime, there is a possible interim workaround that may help stabilize HA failover until a permanent fix is released. This change prevents the standby appliance from disabling its Internet interfaces, which can allow proper failover behavior when the Slave takes over.\n\nWorkaround steps (apply on both Master and Slave appliances):\n\n\t* Connect to the appliance via SSH using the root account.\n\t* Edit the file /etc/opt/kerio/winroute/kr.conf\n\t* Add this line at the end of the file: DisableInternetInterfaces=0\n\t* Save the file.\n\t* Restart the Kerio Control service with: /etc/init.d/kerio-control restart\n\nImportant notes:\n\n\t* This is an interim workaround and not part of the standard documented configuration.\n\t* Please test this change in your environment before applying to production.\n\t* We will update you as soon as Engineering provides confirmation and guidance on a permanent resolution.\n\nBest regards,\nGFI - Kerio Control Support Team"
        ],
        [
          "2025-10-02T15:49:21+00:00",
          "Kayako - ticket id 60196166 // CE Maintenance Bot commented privately: Opened engineering issue https://github.com/trilogy-group/eng-maintenance/issues/14502"
        ],
        [
          "2025-10-02T15:37:59+00:00",
          "Kayako - ticket id 60196166 // Mike Kebede commented privately: @Carlos Encalada as per https://support.keriocontrol.gfi.com/article/116372-configuring-high-availability-in-kerio-control it is actually possible to set up a single public IP for both appliances.\n\nimage"
        ],
        [
          "2025-10-02T15:15:12+00:00",
          "Kayako - ticket id 60196166 // Carlos Encalada commented privately: :: Info ::\n\nWan IPs need to be different, if they are the same, then how would the main link know to which appliance the routing must be done?\n\nimage"
        ],
        [
          "2025-10-02T10:38:44+00:00",
          "Kayako - ticket id 60196166 // Mike Kebede commented privately:  Instructions [https://docs.google.com/document/d/1w6pg-Lqz1Y5n8Gah7JXTRAnNEgnLGDgQn0p4EE_DdyU/edit#bookmark=id.nmtleyh2xrkb] \n\nWHAT IS YOUR PROPOSED ACTION?\n(REQUIRED: SELECT ONE, DELETE THE REST)\n\n \t* Send to external team\n\n =============================================================== \n\nWHAT IS THE PR TO THE CUSTOMER?\n\n Dear Slawek, \n\n Thank you for your patience while we reviewed the High Availability (HA) behavior you reported. After analyzing your setup, we have confirmed that this case requires further investigation by our Engineering team. We have escalated the matter accordingly. \n\n In the meantime, there is a possible interim workaround that may help stabilize HA failover until a permanent fix is released. This change prevents the standby appliance from disabling its Internet interfaces, which can allow proper failover behavior when the Slave takes over. \n\n Workaround steps (apply on both Master and Slave appliances): \n\n \t* Connect to the appliance via SSH using the root account.\n \t* Edit the file /etc/opt/kerio/winroute/kr.conf\n \t* Add this line at the end of the file: DisableInternetInterfaces=0\n \t* Save the file.\n \t* Restart the Kerio Control service with: /etc/init.d/kerio-control restart\n\n Important notes: \n\n \t* This is an interim workaround and not part of the standard documented configuration.\n \t* Please test this change in your environment before applying to production.\n \t* We will update you as soon as Engineering provides confirmation and guidance on a permanent resolution.\n\n Best regards, \n Mike Kebede \n Support Team \n\n =============================================================== \n\nADDITIONAL CONTEXT?\n\n GHI - Escalation to Eng\n\n Subject: HA Configuration Issue: Missing Flags on Slave Device \n\nIssue Name: Missing Primary/Backup WAN Link Flags After HA Failover \n\nShort description: After a High Availability failover in Kerio Control, the Slave device does not retain WAN link Primary/Backup flags, resulting in connectivity failure. \n\n Big Description:\nA customer encountered a critical issue in a Kerio Control High Availability (HA) environment. Upon failover, the Slave device becomes active but loses the Primary/Backup flags on its WAN interfaces configured under the Multiple Internet Links \u2013 Failover mode. This causes the default gateway to be unresolvable and both WAN links to appear administratively down. The problem is reproducible on both virtual environments and NG511 hardware units, which eliminates platform-specific concerns. All configurations were confirmed to be identical on both Master and Slave.\nThis behavior does not match documented HA behavior and is likely a product-level defect in the failover logic related to interface role metadata. \n Behavior\nDetails: \n\n \t* Actual behavior:\nAfter HA failover, the Slave device brings up WAN interfaces without Primary/Backup flags. As a result, it displays a \u201cProblem with default gateway\u201d warning and loses Internet connectivity.\n \t* Expected behavior:\nThe Slave, upon becoming active, should retain or reapply the WAN link roles (Primary/Backup) from the Master to ensure proper routing and failover continuity.\n\n\t* Steps to reproduce: \n\n \t* Configure two Kerio Control devices (Master and Slave) in HA with identical settings, including identical WAN interface names and IP addresses.\n \t* Enable Multiple Internet Links \u2013 Failover mode and assign Primary/Backup roles on both WAN links.\n \t* Establish HA sync and validate Master is active.\n \t* Initiate a failover (e.g., power off Master).\n \t* Observe the Slave interface configuration after takeover.\n\n\t* Evidence: \n\n \t* Screenshot: Slave - after HA failover.png: WAN interfaces up but lacking Primary/Backup roles; warning Problem with default gateway visible.\n \t* Video: Control_HA_webm.webm: Demonstrates WAN link role loss after failover.\n \t* Debug logs: Entries confirm disabling of WAN interfaces on Slave and no reassignment of role flags post-sync.\n \t* Log excerpt:\n{HighAvailability} Disabling 'WAN' automatically from high availability.\n{HighAvailability} Disabling 'Ethernet 2' automatically from high availability.\n \t* Confirmed on NG511 hardware and virtual lab with identical outcomes.\n\n =============================================================== \n GPT \n Did you use GPT: Yes/No \n\n If No, add the reason below. "
        ],
        [
          "2025-10-02T06:19:55+00:00",
          "Kayako - ticket id 60196166 // Atilla Onay commented publicly: Dear Slawek,\n\nWe have received your escalation and we are working on it.\n\nOur team will review the details related to the HA configuration issue you've reported. We understand the importance of this matter and are committed to investigating it thoroughly. We appreciate your patience as we assess the situation further.\n\nBest regards,\nAtilla Onay\nGFI - Kerio Control Support Team"
        ],
        [
          "2025-10-02T06:17:37+00:00",
          "Kayako - ticket id 60196166 // Centralsupport-ai-acc commented privately: [customer_escalation]\n\nThe customer escalated the Case.\n\nThe customer message is:The customer is waiting for confirmation that this is a bug in the product\n\nThe severity is: core_functionality_defect\n\n"
        ],
        [
          "2025-09-25T07:52:16+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello.\n\nThank you for your reply. I disagree that the problem is related to the configuration or the fact that I ran the tests in a virtual environment. I've double-checked that the configurations on the Master and Slave devices are identical.\n\u00a0\nThe customer has two NG511 devices, and they experienced the same issue. They reported the problem to me, and then I performed my tests.\n\nHave you tested this on your end? Does the HA setup in the WAN connection configuration set to failover mode work correctly?\n\nCould you confirm whether we found an issue in the product/release? I need to reply to the customer and let him know if the vendor will fix the issue in a future release.\n\nRegards.\nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/]\nSun Capital sp. z o.o.\nPOLAND\n\nimage\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: ATLAS (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 24-09-2025 14:46\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\nYou are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update:\n\nDear Slawomir,\n\nThank you for providing comprehensive diagnostic information and detailed documentation regarding the issue with missing Primary/Backup flags on WAN links in your Kerio Control High Availability (HA) setup. Based on the analysis of the support info files, debug logs, screenshots, and referenced knowledge base articles, I can confirm the following findings and offer the most relevant guidance.\n\nSummary of Observations:\n\n\t* The HA configuration between your devices is successfully established\u2014status and health checks reflect \u201cOK.\u201d\n\t* Your environment is configured for \"Multiple Internet Links - Failover\" with distinct Primary/Backup designations on the Master.\n\t* After HA synchronization or a failover event, the Slave device\u2019s WAN links are set to DOWN and lose their Primary/Backup flags. This results in a \u201cProblem with default gateway\u201d warning and loss of outbound connectivity on the Slave during failover. The issue is visible in both screenshots and the support info files.\n\t* Debug and error logs confirm there is no explicit restoration or assignment of Primary/Backup status to WAN links on the Slave after failover\u2014only the generic interface states (UP/DOWN) are managed, without preserving the original role designation.\n\t* The behavior you are experiencing\u2014loss of WAN role metadata on the Slave after HA failover\u2014is not documented as expected or normal in the official knowledge base.\n\nRelevant Knowledge Base Guidance:\n\n\t* The article Kerio Control High Availability (HA) Special cases [https://support.keriocontrol.gfi.com/article/116379] details HA management of interface states (such as disabling Wi-Fi or PPPoE on the Slave) and the automated handling of routes, DHCP, and virtual IPs. However, it does not mention that standard Ethernet WAN interfaces should lose their Primary/Backup roles, nor is there any reference to the role metadata being intentionally omitted or reset during HA failover.\n\t* From your logs and knowledge base details, while the disabling/enabling of interfaces is expected for certain interface types, loss of WAN failover roles (Primary/Backup) is not documented or intended behavior for Ethernet interfaces in a standard HA setup.\n\t* If you are testing in an environment with identical interface names and configurations (which you have confirmed), the role assignments should persist during HA transitions. Their disappearance strongly suggests a product issue or an unhandled edge case in the current software version.\n\nPotential Workarounds & Recommendations:\n\n\t* Verify that both Master and Slave have absolutely identical interface names, counts, and credentials, as slight mismatches can cause sync problems. There is no evidence in your files that this is the issue, but it is worth double-checking in production deployments.\n\t* If you are running on a virtual platform, ensure that all network interfaces are consistently provisioned and assigned with persistent naming\u2014dynamic changes in the host may interfere with HA mapping.\n\n\t* You may attempt the configuration modifications as detailed in these articles for interface control:\n\n\t* Disabling HA Configuration for Internet Interfaces [https://support.keriocontrol.gfi.com/article/116350] \u2013 This guide shows how to control whether Kerio disables interfaces on the Slave by default. You can test setting DisableInternetInterfaces=0 on both devices via SSH to see if this impacts restoration of interface roles after failover.\n\t* After making such a change, restart the Kerio Control service as instructed and re-test your HA failover scenario.\n\n\t* The warning regarding running with less than recommended RAM is not critical for interface failover behavior but may affect Intrusion Prevention System (IPS) performance. Consider expanding available memory as per the suggestion in your logs (\u201cFor better IPS performance, please, consider expansion to at least 2096MB\u201d).\n\nKey References:\n\n\t* Kerio Control High Availability (HA) Special cases [https://support.keriocontrol.gfi.com/article/116379]\n\t* Disabling HA Configuration for Internet Interfaces [https://support.keriocontrol.gfi.com/article/116350]\n\nSummary:\n\nThe behavior where the Slave device in HA loses WAN Primary/Backup designations after failover does not match documented or expected Kerio Control operations and appears to be a product limitation or defect. Standard troubleshooting and configuration verification steps have already been performed on your side. If the above workaround with the DisableInternetInterfaces parameter does not restore the desired failover behavior, this scenario would require attention in a future product update, as there is no documented configuration or field-level fix currently available to resolve this loss of interface role metadata within the existing version.\n\nIf you have any further technical questions or need clarification on any of the references, please let me know and I will provide any additional guidance available.\n\nSincerely,\nAtlas\nGFI - Kerio Control Support Team.\n\n-------------------------\n\nThis response contains information generated with 3rd party components for which we disclaim all responsibility. For more details, you can check the terms and conditions at: chattbotterms.trilogy.com [https://chatbotterms.trilogy.com]\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Closed in the portal. We will write to you again to remind you.\n\nSent with Kayako [https://kayako.com]image \n"
        ],
        [
          "2025-09-24T12:46:32+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented publicly: Dear Slawomir,\n\nThank you for providing comprehensive diagnostic information and detailed documentation regarding the issue with missing Primary/Backup flags on WAN links in your Kerio Control High Availability (HA) setup. Based on the analysis of the support info files, debug logs, screenshots, and referenced knowledge base articles, I can confirm the following findings and offer the most relevant guidance.\n\nSummary of Observations:\n\n \t* The HA configuration between your devices is successfully established\u2014status and health checks reflect \u201cOK.\u201d\n \t* Your environment is configured for \"Multiple Internet Links - Failover\" with distinct Primary/Backup designations on the Master.\n \t* After HA synchronization or a failover event, the Slave device\u2019s WAN links are set to DOWN and lose their Primary/Backup flags. This results in a \u201cProblem with default gateway\u201d warning and loss of outbound connectivity on the Slave during failover. The issue is visible in both screenshots and the support info files.\n \t* Debug and error logs confirm there is no explicit restoration or assignment of Primary/Backup status to WAN links on the Slave after failover\u2014only the generic interface states (UP/DOWN) are managed, without preserving the original role designation.\n \t* The behavior you are experiencing\u2014loss of WAN role metadata on the Slave after HA failover\u2014is not documented as expected or normal in the official knowledge base.\n\nRelevant Knowledge Base Guidance:\n\n \t* The article Kerio Control High Availability (HA) Special cases [https://support.keriocontrol.gfi.com/article/116379] details HA management of interface states (such as disabling Wi-Fi or PPPoE on the Slave) and the automated handling of routes, DHCP, and virtual IPs. However, it does not mention that standard Ethernet WAN interfaces should lose their Primary/Backup roles, nor is there any reference to the role metadata being intentionally omitted or reset during HA failover.\n \t* From your logs and knowledge base details, while the disabling/enabling of interfaces is expected for certain interface types, loss of WAN failover roles (Primary/Backup) is not documented or intended behavior for Ethernet interfaces in a standard HA setup.\n \t* If you are testing in an environment with identical interface names and configurations (which you have confirmed), the role assignments should persist during HA transitions. Their disappearance strongly suggests a product issue or an unhandled edge case in the current software version.\n\nPotential Workarounds & Recommendations:\n\n \t* Verify that both Master and Slave have absolutely identical interface names, counts, and credentials, as slight mismatches can cause sync problems. There is no evidence in your files that this is the issue, but it is worth double-checking in production deployments.\n \t* If you are running on a virtual platform, ensure that all network interfaces are consistently provisioned and assigned with persistent naming\u2014dynamic changes in the host may interfere with HA mapping.\n\n\t* You may attempt the configuration modifications as detailed in these articles for interface control: \n\n \t* Disabling HA Configuration for Internet Interfaces [https://support.keriocontrol.gfi.com/article/116350] \u2013 This guide shows how to control whether Kerio disables interfaces on the Slave by default. You can test setting DisableInternetInterfaces=0 on both devices via SSH to see if this impacts restoration of interface roles after failover.\n \t* After making such a change, restart the Kerio Control service as instructed and re-test your HA failover scenario.\n\n \t* The warning regarding running with less than recommended RAM is not critical for interface failover behavior but may affect Intrusion Prevention System (IPS) performance. Consider expanding available memory as per the suggestion in your logs (\u201cFor better IPS performance, please, consider expansion to at least 2096MB\u201d).\n\nKey References:\n\n \t* Kerio Control High Availability (HA) Special cases [https://support.keriocontrol.gfi.com/article/116379]\n \t* Disabling HA Configuration for Internet Interfaces [https://support.keriocontrol.gfi.com/article/116350]\n\nSummary:\n\nThe behavior where the Slave device in HA loses WAN Primary/Backup designations after failover does not match documented or expected Kerio Control operations and appears to be a product limitation or defect. Standard troubleshooting and configuration verification steps have already been performed on your side. If the above workaround with the DisableInternetInterfaces parameter does not restore the desired failover behavior, this scenario would require attention in a future product update, as there is no documented configuration or field-level fix currently available to resolve this loss of interface role metadata within the existing version.\n\nIf you have any further technical questions or need clarification on any of the references, please let me know and I will provide any additional guidance available.\n\nSincerely,\nAtlas\nGFI - Kerio Control Support Team.\n\n-------------------------\n\nThis response contains information generated with 3rd party components for which we disclaim all responsibility. For more details, you can check the terms and conditions at: chattbotterms.trilogy.com [https://chatbotterms.trilogy.com]\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Closed in the portal. We will write to you again to remind you."
        ],
        [
          "2025-09-24T12:45:42+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented privately: :: FILE ANALYSIS RESULTS ::\n\n \t\tFILE\n \t\tOBSERVATIONS\n\n \t\tkerio_support_info_Master.txt_1554396\n \t\tHigh Availability (HA) synchronization and interface mapping appear to complete successfully, but the expected Primary/Backup flags on WAN links are not present after failover.\n \t\tThe debug log shows successful HA synchronization steps (e.g., '[12/Sep/2025 07:24:28] {HighAvailability} Daemon State changed from Failure (No Virtual IPs Assigned) to OK' and 'Peer interface list is matching with local interfaces.'). However, customer reports and screenshots confirm that after failover, the Slave device loses the Primary/Backup flags on WAN interfaces, which is not expected. This is corroborated by the absence of any log entries indicating assignment of these flags post-failover. This impacts the ability of the Slave to establish a default gateway, causing WAN connectivity to fail after takeover. According to the knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379), HA is expected to manage interface states and routes automatically, and the loss of interface flags is not documented as normal behavior. This suggests a possible product defect or an edge case not covered by standard configuration. Please review the article for further details on HA interface and route management.\n\n \t\tSystem is running with less than the recommended RAM for optimal Intrusion Prevention System (IPS) performance.\n \t\tThe warning log repeatedly states 'RAM size is 1995MB. For better IPS performance, please, consider expansion to at least 2096MB.' (e.g., [12/Sep/2025 07:22:31]). The system information confirms 1995 MB RAM. While this is not a critical failure, it may degrade IPS performance or stability under load, especially in HA or multi-WAN scenarios.\n\n \t\tNo valid license is present, which disables IPS updates and may restrict other product functionality.\n \t\tThe error and warning logs contain multiple entries such as 'There is no valid license for the product!' and 'IPS rules update: No valid license found.' (e.g., [12/Sep/2025 08:15:20]). The install type is listed as 'Trial' in the General Information section. This means IPS signatures are not updating, and some features may be limited or disabled, which can impact security and troubleshooting.\n\n \t\tDNS resolution and product update failures are present, likely as a consequence of the default gateway problem after failover.\n \t\tThe error log shows repeated failures to resolve external hosts, e.g., '(2) Product update failed. Error: Check failed (Could not resolve host: prod-update.kerio.com)' and '(101) Failed to send DNS query to server 8.8.8.8'. These failures correlate with the reported default gateway issue after HA failover, confirming that the system loses external connectivity when the Slave becomes active and the WAN interfaces are not properly flagged. The knowledgebase article 'Kerio Control High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) explains that when the Slave has no active Internet interfaces, a static route is created to allow updates via the sync interface. However, in this case, the expected failover behavior is not occurring, which is consistent with the observed connectivity loss.\n\n \t\tNo evidence of file descriptor leaks or abnormal open files/sockets.\n \t\tThe netstat and lsof outputs (as reflected in the netstat -anp and UNIX domain sockets listings) show a typical number of open sockets and files for a Kerio Control system of this size and configuration. There are no excessive or abnormal entries that would indicate a backend resource leak.\n\n \t\tSystem resource usage is healthy and stable.\n \t\tThe top, free, and /proc/meminfo outputs show low CPU usage (0% user/system), low RAM usage (1371 MB free of 1995 MB), and no swap usage. The system has been up for 7 minutes with a load average of 0.00. There are no signs of memory pressure, CPU contention, or process instability.\n\n \t\tThe root filesystem is nearly full, but /var (where logs and most runtime data reside) has ample free space.\n \t\tdf -h shows '/dev/sda2' (mounted as /) is at 91% usage with only 89 MB free, but '/dev/sda4' (mounted as /var) has 13 GB free. While the root partition is small and nearly full, this is unlikely to cause immediate issues unless further growth occurs. However, it should be monitored to avoid potential problems with package updates or system logging.\n\n \t\tNo evidence of Kerio Control running inside a Docker container.\n \t\tThe process tree (ps -axfl) shows a standard Linux environment with Kerio Control processes running directly under init/systemd, not as child processes of a container runtime (e.g., docker, containerd). There are no signs of overlay filesystems or container-specific process hierarchies.\n\n \t\tkerio_support_info_Slave.txt_1554397\n \t\tPrimary/Backup flags missing on WAN interfaces after HA failover, resulting in default gateway issues.\n \t\tThe debug log at [12/Sep/2025 07:24:28] shows High Availability (HA) events where both 'WAN' and 'Ethernet 2' interfaces are automatically disabled on the slave after HA sync. The customer and screenshots confirm that after failover, the slave device loses Primary/Backup flags on WAN links and cannot establish a default gateway. This is consistent with the log lines: '{HighAvailability} Disabling 'WAN' automatically from high availability.' and '{HighAvailability} Disabling 'Ethernet 2' automatically from high availability.' This behavior is not expected in a healthy HA setup and directly causes WAN connectivity loss on the slave, matching the reported issue. The knowledgebase article 'High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) documents that Kerio Control disables certain interfaces (like Wi-Fi and PPPoE) on the slave during HA validation, but does not mention disabling standard Ethernet WAN interfaces or the loss of Primary/Backup flags. Therefore, this observed behavior is not documented as expected and may indicate a product bug or an undocumented edge case.\n\n \t\tHA synchronization and configuration merge processes are completing successfully, but interface state logic appears faulty.\n \t\tThe debug log repeatedly shows successful HA config merges (e.g., '[HighAvailability] High Availability dispatcher processMergeConfigs finished, doing cleanup for received data..' and 'All peer config loaded succesfully'). Interface lists are validated as matching ('Peer interface list is matching with local interfaces.'). However, the subsequent disabling of internet interfaces and loss of Primary/Backup flags suggest a logic or product bug in the HA interface state transition, not a sync failure or config mismatch. The knowledgebase article 'High Availability (HA) Special cases' (https://support.keriocontrol.gfi.com/article/116379) clarifies that interface validation and config sync should not result in the loss of WAN interface roles or flags. This supports the conclusion that the observed behavior is not expected or documented.\n\n \t\tSystem is running with insufficient RAM for optimal IPS performance.\n \t\tThe warning log contains multiple entries such as '[12/Sep/2025 06:05:10] RAM size is 1995MB. For better IPS performance, please, consider expansion to at least 2096MB.' The system has 2GB RAM (see [System Information] and 'MemTotal: 2043360 kB' in /proc/meminfo), which is below the recommended minimum for full Intrusion Prevention System (IPS) performance. While not directly related to the HA issue, this could impact system stability or IPS throughput under load.\n\n \t\tNo valid product license detected, which may limit functionality and updates.\n \t\tThe warning log at '[28/Aug/2025 11:42:03] There is no valid license for the product!' and error log '[12/Sep/2025 06:27:55] IPS rules update: No valid license found.' indicate the system is running in trial mode or with an expired license. This can prevent IPS rule updates, product updates, and may restrict support or advanced features, potentially impacting security and troubleshooting.\n\n \t\tDatabase schema update failures detected for Firebird DB, specifically related to collation settings.\n \t\tThe error log shows repeated Firebird DB errors: 'COLLATION UNICODE_FSS for CHARACTER SET NONE is not defined' and 'DB schema update failed on file star-1.02.sql'. This indicates that certain database migrations or features relying on the 'star' module may not function correctly. While not directly related to HA, persistent DB schema errors can cause instability or loss of reporting/statistics functionality.\n\n \t\tDisk space on root filesystem is critically low.\n \t\tThe 'df -h' output shows '/dev/sda2 973M 885M 89M 91% /', meaning only 89MB free on the root partition. While /var has ample space, the root filesystem being over 90% full can cause issues with logging, updates, or temporary file creation, especially during upgrades or heavy logging.\n\n \t\tNo evidence of file descriptor leaks or abnormal open files/sockets.\n \t\tThe netstat and UNIX socket listings show a typical number of open sockets for the running services. There are no signs of excessive or abnormal open files or sockets that would indicate a backend resource leak. The system appears stable in this regard.\n\n \t\tSystem resource usage (CPU, memory, swap) is healthy and not under stress.\n \t\tThe top and free outputs show low CPU usage ('load average: 0.02, 0.07, 0.04'), over 1GB free RAM, and no swap usage. The main Kerio process (winroute) is using 16% of RAM, which is expected. There are no signs of resource exhaustion or performance bottlenecks at the time of the support info capture.\n\n \t\tNetwork interfaces are up and detected, but link speed/duplex is unknown due to virtualized environment.\n \t\tThe ifconfig and ethstatus outputs show all interfaces (eth0-eth3, kvnet) as UP with link detected. However, 'Speed: Unknown!' and 'Duplex: Unknown! (255)' are reported, which is typical for Virtio interfaces in a QEMU/KVM virtual machine. This does not indicate a problem but should be noted for completeness.\n\n \t\tdebug.log.txt_9150564765117103475048\n\n-\u00a0The\u00a0logs\u00a0show\u00a0that\u00a0during\u00a0High\u00a0Availability\u00a0(HA)\u00a0events\u00a0(initialization,\u00a0master\u00a0down,\u00a0master\u00a0up),\u00a0the\u00a0slave\u00a0device\u00a0disables\u00a0its\u00a0internet\u00a0interfaces,\u00a0specifically\u00a0the\u00a0'WAN'\u00a0and\u00a0sometimes\u00a0also\u00a0'Ethernet\u00a02',\u00a0as\u00a0part\u00a0of\u00a0\u201cDisabling\u00a0internet\u00a0interfaces\u201d\u00a0(\u201cDisabling\u00a0'WAN'\u00a0automatically\u00a0from\u00a0high\u00a0availability.\u201d).\n-\u00a0After\u00a0initiating\u00a0HA\u00a0or\u00a0after\u00a0failover\u00a0events,\u00a0interfaces\u00a0such\u00a0as\u00a0'WAN'\u00a0on\u00a0the\u00a0slave\u00a0are\u00a0deliberately\u00a0set\u00a0to\u00a0DOWN\u00a0with\u00a0log\u00a0messages\u00a0(\u201cDisabling\u00a0'WAN'\u00a0automatically\u00a0from\u00a0high\u00a0availability\u201d)\u2014but\u00a0their\u00a0previous\u00a0Primary/Backup\u00a0failover\u00a0roles\u00a0are\u00a0not\u00a0clearly\u00a0preserved/restored\u00a0in\u00a0the\u00a0logs.\n-\u00a0During\u00a0configuration\u00a0merges\u00a0(mergeconfig\u00a0actions\u00a0for\u00a0winroute.cfg\u00a0and\u00a0other\u00a0.cfg\u00a0files),\u00a0there\u00a0is\u00a0no\u00a0explicit\u00a0indication\u00a0that\u00a0the\u00a0Primary/Backup\u00a0flags\u00a0for\u00a0WAN\u00a0links\u00a0are\u00a0being\u00a0set,\u00a0transferred,\u00a0or\u00a0re-applied\u00a0on\u00a0the\u00a0slave\u00a0device\u00a0after\u00a0HA\u00a0events.\n-\u00a0In\u00a0the\u00a0event\u00a0of\u00a0the\u00a0master\u00a0being\u00a0down\u00a0or\u00a0failover\u00a0occurring,\u00a0the\u00a0slave\u00a0executes\u00a0\u201cEnabling\u00a0internet\u00a0interfaces\u201d\u00a0and\u00a0\u201cEnabling\u00a0'WAN'\u00a0automaticallay\u00a0from\u00a0high\u00a0availability,\u201d\u00a0but\u00a0there\u00a0is\u00a0no\u00a0record\u00a0in\u00a0the\u00a0log\u00a0confirming\u00a0that\u00a0original\u00a0Primary/Backup\u00a0designations\u00a0are\u00a0restored\u00a0or\u00a0re-designated\u00a0on\u00a0those\u00a0interfaces.\n-\u00a0The\u00a0HA\u00a0events\u00a0show\u00a0that\u00a0after\u00a0master\u00a0down\u00a0(making\u00a0the\u00a0slave\u00a0active),\u00a0although\u00a0the\u00a0WAN\u00a0interfaces\u00a0are\u00a0brought\u00a0up\u00a0(\u201cEnabling\u00a0'WAN'\u00a0automaticallay\u00a0from\u00a0high\u00a0availability\u201d),\u00a0there\u00a0is\u00a0no\u00a0log\u00a0entry\u00a0to\u00a0indicate\u00a0the\u00a0assignment\u00a0(or\u00a0reassignment)\u00a0of\u00a0WAN\u00a0link\u00a0roles\u00a0(Primary/Backup\u00a0flags)\u2014the\u00a0roles\u00a0appear\u00a0to\u00a0be\u00a0lost/omitted\u00a0in\u00a0this\u00a0process.\n-\u00a0Multiple\u00a0cycles\u00a0of\u00a0interface\u00a0validation\u00a0and\u00a0config\u00a0syncing\u00a0between\u00a0master\u00a0and\u00a0slave\u00a0do\u00a0not\u00a0mention\u00a0any\u00a0payload\u00a0that\u00a0includes\u00a0WAN\u00a0link\u00a0role\u00a0metadata.\n-\u00a0The\u00a0configuration\u00a0sync\u00a0process\u00a0frequently\u00a0logs\u00a0\u201cDisabling\u00a0internet\u00a0interfaces\u201d\u00a0after\u00a0a\u00a0failover\u00a0or\u00a0HA\u00a0initialization,\u00a0implying\u00a0that\u00a0the\u00a0interfaces\u00a0are\u00a0managed\u00a0actively\u00a0by\u00a0the\u00a0HA\u00a0subsystem,\u00a0possibly\u00a0resetting\u00a0or\u00a0losing\u00a0role\u00a0metadata.\n-\u00a0After\u00a0HA\u00a0failover\u00a0and\u00a0subsequent\u00a0merges/config\u00a0syncs,\u00a0the\u00a0logs\u00a0consistently\u00a0lack\u00a0any\u00a0indication\u00a0of\u00a0restoring\u00a0WAN\u00a0link\u00a0failover\u00a0roles\u00a0such\u00a0as\u00a0Primary/Backup;\u00a0only\u00a0generic\u00a0interface\u00a0state\u00a0changes\u00a0are\u00a0recorded.\n-\u00a0The\u00a0logs\u00a0show\u00a0events\u00a0around\u00a0interface\u00a0disabling/enabling\u00a0and\u00a0DHCP\u00a0scope\u00a0switching,\u00a0but\u00a0not\u00a0about\u00a0WAN\u00a0failover\u00a0configuration\u00a0status\u00a0syncing.\n-\u00a0The\u00a0logs\u00a0record\u00a0the\u00a0disabling/enabling\u00a0of\u00a0interfaces,\u00a0removal/addition\u00a0of\u00a0static\u00a0routes,\u00a0and\u00a0virtual\u00a0IPs\u00a0handling,\u00a0but\u00a0make\u00a0no\u00a0distinction\u00a0between\u00a0interfaces\u00a0that\u00a0are\u00a0Primary\u00a0or\u00a0Backup\u00a0for\u00a0failover\u00a0purposes.\n-\u00a0All\u00a0observed\u00a0merges\u00a0and\u00a0interface\u00a0events\u00a0in\u00a0the\u00a0logs\u00a0are\u00a0accompanied\u00a0by\u00a0disabling/enabling\u00a0actions,\u00a0but\u00a0the\u00a0handling\u00a0of\u00a0WAN\u00a0link\u00a0failover\u00a0role\u00a0data\u00a0(Primary/Backup\u00a0flag\u00a0assignment)\u00a0is\u00a0not\u00a0present\u00a0in\u00a0any\u00a0log\u00a0entries.\n-\u00a0There\u00a0are\u00a0clear\u00a0signs\u00a0that\u00a0after\u00a0each\u00a0HA\u00a0state\u00a0transition,\u00a0the\u00a0only\u00a0information\u00a0about\u00a0interface\u00a0status\u00a0concerns\u00a0administrative\u00a0state\u00a0(UP/DOWN)\u00a0and\u00a0IP\u00a0addresses,\u00a0not\u00a0failover\u00a0role\u00a0metadata.\n-\u00a0The\u00a0activation/deactivation\u00a0of\u00a0internet\u00a0interfaces\u00a0(\u2018WAN\u2019\u00a0and\u00a0\u2018Ethernet\u00a02\u2019)\u00a0on\u00a0HA\u00a0events\u00a0is\u00a0automated,\u00a0yet\u00a0no\u00a0record\u00a0exists\u00a0of\u00a0role-specific\u00a0attributes\u00a0(e.g.,\u00a0which\u00a0WAN\u00a0is\u00a0Primary/Backup)\u00a0making\u00a0it\u00a0likely\u00a0that\u00a0such\u00a0information\u00a0is\u00a0not\u00a0persisted\u00a0or\u00a0restored.\n-\u00a0During\u00a0each\u00a0HA\u00a0config\u00a0merge\u00a0(\u201cmergeconfig\u201d),\u00a0configurations\u00a0like\u00a0winroute.cfg\u00a0are\u00a0merged,\u00a0but\u00a0there\u00a0is\u00a0no\u00a0reference\u00a0to\u00a0WAN\u00a0role\u00a0failover\u00a0status,\u00a0suggesting\u00a0a\u00a0gap\u00a0in\u00a0configuration\u00a0replication\u00a0logic\u00a0for\u00a0this\u00a0specific\u00a0attribute.\n-\u00a0Repeated\u00a0and\u00a0explicit\u00a0mention\u00a0of\u00a0\u201cDisabling\u00a0'WAN'\u00a0automatically\u00a0from\u00a0high\u00a0availability\u201d\u00a0without\u00a0subsequent\u00a0contextual\u00a0restoration\u00a0or\u00a0retention\u00a0of\u00a0WAN\u00a0failover\u00a0roles\u00a0aligns\u00a0with\u00a0the\u00a0customer\u2019s\u00a0observation\u00a0of\u00a0Primary/Backup\u00a0flags\u00a0missing\u00a0on\u00a0the\u00a0slave\u00a0device\u00a0after\u00a0failover.\n\n \t\terror.log.txt_9150564765117103475048\n\n-\u00a0Multiple\u00a0instances\u00a0of\u00a0the\u00a0following\u00a0appear\u00a0after\u00a0the\u00a0date/time\u00a0the\u00a0customer\u00a0began\u00a0testing\u00a0(12/Sep/2025):\n-\u00a0Firebird\u00a0DB\u00a0errors\u00a0such\u00a0as\u00a0\u201cUnable\u00a0to\u00a0create\u00a0database\u201d,\u00a0\u201cUnsuccessful\u00a0execution\u00a0caused\u00a0by\u00a0a\u00a0system\u00a0error\u201d,\u00a0and\u00a0\u201cDatabase\u00a0already\u00a0opened\u00a0with\u00a0engine\u00a0instance,\u00a0incompatible\u00a0with\u00a0current\u201d.\n-\u00a0Repeated\u00a0failures\u00a0to\u00a0process\u00a0schema\u00a0update\u00a0files\u00a0(star/ddl/star-1.02.sql)\u00a0due\u00a0to\u00a0SQL\u00a0error\u00a0code\u00a0=\u00a0-204,\u00a0\u201cCOLLATION\u00a0UNICODE_FSS\u00a0for\u00a0CHARACTER\u00a0SET\u00a0NONE\u00a0is\u00a0not\u00a0defined,\u201d\u00a0and\u00a0failed\u00a0metadata\u00a0updates\u00a0(e.g.,\u00a0CREATE\u00a0TABLE\u00a0MISC\u00a0failed).\n-\u00a0\u201cDB:\u00a0schema\u00a0version\u00a0is\u00a0too\u00a0low\u00a0even\u00a0after\u00a0successful\u00a0update\u00a0(1,010000\u00a0<\u00a01,200000).\u00a0Invalid\u00a0upgrade\u00a0scripts?\u201d\u00a0message\u00a0is\u00a0logged\u00a0repeatedly.\n-\u00a0There\u00a0are\u00a0several\u00a0errors\u00a0like\u00a0\u201cUnable\u00a0to\u00a0clear\u00a0star\u00a0directory\u00a0'activity':\u00a01\u201d\u00a0and\u00a0\u201cUnable\u00a0to\u00a0clear\u00a0star\u00a0directory\u00a0'data':\u00a01\u201d\u00a0which\u00a0may\u00a0indicate\u00a0file\u00a0or\u00a0database\u00a0lock\u00a0problems.\n-\u00a0Messages\u00a0such\u00a0as\u00a0\u201cUnable\u00a0to\u00a0process\u00a0DDL\u00a0file\u201d\u00a0and\u00a0\u201cDB\u00a0schema\u00a0update\u00a0failed\u00a0on\u00a0file\u00a0star-1.02.sql\u201d\u00a0constantly\u00a0repeat,\u00a0indicating\u00a0persistent\u00a0database/schema\u00a0synchronization\u00a0or\u00a0incompatibility\u00a0issues.\n-\u00a0Product\u00a0update\u00a0and\u00a0DNS\u00a0query\u00a0failures\u00a0noted:\u00a0\u201cProduct\u00a0update\u00a0failed.\u00a0Error:\u00a0Check\u00a0failed\u00a0(Could\u00a0not\u00a0resolve\u00a0host:\u00a0prod-update.kerio.com)\u201d\u00a0and\u00a0numerous\u00a0\u201cFailed\u00a0to\u00a0send\u00a0DNS\u00a0query\u00a0to\u00a0server...\u201d\u00a0errors,\u00a0suggesting\u00a0communication\u00a0issues\u00a0that\u00a0could\u00a0be\u00a0connected\u00a0to\u00a0the\u00a0loss\u00a0of\u00a0WAN\u00a0failover\u00a0capability\u00a0or\u00a0interface\u00a0state.\n-\u00a0Starred\u00a0\u201cError\u00a0occurred\u00a0while\u00a0executing\u00a0up\u00a0script\u201d\u00a0message\u00a0which\u00a0may\u00a0point\u00a0toward\u00a0startup\u00a0or\u00a0initialization\u00a0failures.\n-\u00a0IPS\u00a0rules\u00a0update\u00a0failures:\u00a0\u201cIPS\u00a0rules\u00a0update:\u00a0No\u00a0valid\u00a0license\u00a0found,\u201d\u00a0which\u00a0may\u00a0signify\u00a0an\u00a0inability\u00a0to\u00a0synchronize\u00a0licenses\u00a0between\u00a0HA\u00a0nodes\u00a0due\u00a0to\u00a0connectivity/database\u00a0issues.\n-\u00a0Sequence\u00a0of\u00a0database\u00a0and\u00a0schema\u00a0issues\u00a0correlates\u00a0with\u00a0customer\u2019s\u00a0reported\u00a0behavior\u00a0during\u00a0or\u00a0after\u00a0HA\u00a0failover/link\u00a0state\u00a0change\u00a0events.\n\n \t\tkerio_support_info_Master.txt_3532751011141051113267111\n\n-\u00a0The\u00a0Kerio\u00a0Control\u00a0system\u00a0is\u00a0running\u00a0version\u00a09.5.0\u00a0patch\u00a03\u00a0build\u00a09017;\u00a0it\u00a0is\u00a0a\u00a0trial\u00a0installation\u00a0in\u00a0active/passive\u00a0HA\u00a0mode.\n-\u00a0Both\u00a0WAN\u00a0and\u00a0LAN\u00a0interface\u00a0configurations\u00a0are\u00a0present\u00a0and\u00a0both\u00a0use\u00a0static\u00a0addressing;\u00a0WAN\u00a0addresses\u00a0192.168.150.160/161/162\u00a0are\u00a0assigned\u00a0to\u00a0eth0,\u00a0and\u00a0additional\u00a0interface\u00a0eth3\u00a0uses\u00a0192.168.9.160/24.\n-\u00a0Both\u00a0WAN\u00a0links\u00a0on\u00a0the\u00a0Slave\u00a0device\u00a0are\u00a0set\u00a0to\u00a0\u201cDOWN\u201d\u00a0after\u00a0HA\u00a0switchover,\u00a0as\u00a0noted\u00a0by\u00a0the\u00a0customer\u00a0and\u00a0as\u00a0typical\u00a0during\u00a0transition.\n-\u00a0There\u00a0is\u00a0a\u00a0specific\u00a0dashboard\u00a0warning\u00a0on\u00a0the\u00a0Slave\u00a0device:\u00a0\u201cProblem\u00a0with\u00a0default\u00a0gateway,\u201d\u00a0which\u00a0can\u00a0be\u00a0associated\u00a0with\u00a0the\u00a0lack\u00a0of\u00a0Primary/Backup\u00a0flags\u00a0and\u00a0the\u00a0configuration\u00a0of\u00a0default\u00a0routes\u00a0via\u00a0both\u00a0WAN\u00a0connections.\n-\u00a0The\u00a0routing\u00a0table\u00a0and\u00a0\u201cip\u00a0address\u00a0show\u201d\u00a0output\u00a0indicate\u00a0secondary\u00a0and\u00a0even\u00a0tertiary\u00a0IP\u00a0addresses\u00a0on\u00a0WAN\u00a0interfaces,\u00a0which\u00a0could\u00a0cause\u00a0complications\u00a0with\u00a0role\u00a0assignment\u00a0(Primary/Backup)\u00a0if\u00a0flags\u00a0are\u00a0not\u00a0retained\u00a0or\u00a0properly\u00a0synchronized\u00a0post-failover.\n-\u00a0After\u00a0HA\u00a0services\u00a0shutdown\u00a0and\u00a0restart\u00a0(see\u00a0HighAvailability\u00a0logs),\u00a0configuration\u00a0synchronization\u00a0and\u00a0interface\u00a0matching\u00a0complete\u00a0successfully,\u00a0but\u00a0there\u00a0is\u00a0no\u00a0log\u00a0line\u00a0indicating\u00a0explicit\u00a0assignment\u00a0of\u00a0WAN\u00a0link\u00a0roles\u00a0(Primary/Backup)\u00a0to\u00a0interfaces\u00a0after\u00a0role\u00a0transition.\n-\u00a0No\u00a0evidence\u00a0in\u00a0the\u00a0logs\u00a0of\u00a0error\u00a0or\u00a0explicit\u00a0handling\u00a0of\u00a0WAN\u00a0link\u00a0role\u00a0flags\u00a0(Primary/Backup)\u00a0during\u00a0HA\u00a0config\u00a0sync\u00a0or\u00a0in\u00a0the\u00a0merge\u00a0process.\n-\u00a0The\u00a0system\u00a0log\u00a0(\u201cHighAvailability\u201d)\u00a0shows\u00a0a\u00a0config\u00a0merge,\u00a0interface\u00a0sync,\u00a0and\u00a0successful\u00a0validation,\u00a0but\u00a0no\u00a0operation\u00a0indicating\u00a0role\u00a0property\u00a0transfer\u00a0or\u00a0restoration\u00a0from\u00a0the\u00a0Master\u00a0to\u00a0the\u00a0Slave.\n-\u00a0The\u00a0observed\u00a0routing\u00a0table\u00a0on\u00a0the\u00a0Slave\u00a0device\u00a0after\u00a0HA\u00a0initiation\u00a0shows\u00a0a\u00a0single\u00a0default\u00a0route\u00a0via\u00a0192.168.150.1\u00a0(eth0/WAN),\u00a0potentially\u00a0ignoring\u00a0possible\u00a0backup\u00a0role\u00a0configuration\u00a0or\u00a0priority\u00a0for\u00a0the\u00a0secondary\u00a0WAN.\n-\u00a0The\u00a0system\u00a0status\u00a0output,\u00a0route\u00a0tables,\u00a0and\u00a0interface\u00a0status\u00a0all\u00a0indicate\u00a0interfaces\u00a0are\u00a0present,\u00a0up,\u00a0and\u00a0addressed,\u00a0but\u00a0failover\u00a0logic\u00a0for\u00a0WAN\u00a0links\u00a0(including\u00a0flags)\u00a0does\u00a0not\u00a0appear\u00a0to\u00a0persist\u00a0or\u00a0be\u00a0visible\u00a0post-failover.\n-\u00a0There\u00a0is\u00a0no\u00a0evidence\u00a0in\u00a0the\u00a0support\u00a0info\u00a0file\u00a0of\u00a0differences\u00a0in\u00a0interface\u00a0naming,\u00a0IP\u00a0assignment,\u00a0or\u00a0major\u00a0configuration\u00a0mismatch\u00a0between\u00a0HA\u00a0nodes;\u00a0sync\u00a0completes\u00a0without\u00a0errors,\u00a0but\u00a0role-specific\u00a0data\u00a0(link\u00a0failover\u00a0flags)\u00a0is\u00a0not\u00a0observed\u00a0as\u00a0an\u00a0explicit\u00a0synced\u00a0parameter.\n-\u00a0The\u00a0\u201cifconfig\u00a0-a\u201d\u00a0output\u00a0confirms\u00a0all\u00a0physical\u00a0interfaces\u00a0are\u00a0up\u00a0on\u00a0the\u00a0Slave,\u00a0but\u00a0it\u00a0is\u00a0not\u00a0possible\u00a0to\u00a0infer\u00a0any\u00a0logical\u00a0(Kerio)\u00a0WAN\u00a0link\u00a0state\u00a0or\u00a0role\u00a0from\u00a0these\u00a0outputs\u00a0alone.\n-\u00a0The\u00a0\u201cMultiple\u00a0Links\u00a0\u2013\u00a0Failover\u201d\u00a0configuration\u00a0is\u00a0listed,\u00a0but\u00a0there\u00a0is\u00a0no\u00a0configuration\u00a0or\u00a0log\u00a0output\u00a0confirming\u00a0the\u00a0assignment\u00a0or\u00a0recognition\u00a0of\u00a0Primary/Backup\u00a0status\u00a0to\u00a0any\u00a0WAN\u00a0link\u00a0after\u00a0failover\u2014consistent\u00a0with\u00a0the\u00a0described\u00a0problem.\n-\u00a0There\u00a0are\u00a0repeated\u00a0restarts\u00a0of\u00a0HA\u00a0services\u00a0and\u00a0configurations\u00a0being\u00a0applied,\u00a0but\u00a0no\u00a0log\u00a0callback\u00a0for\u00a0restoring\u00a0or\u00a0displaying\u00a0link\u00a0role\u00a0assignments,\u00a0indicating\u00a0the\u00a0problem\u00a0is\u00a0at\u00a0the\u00a0configuration\u00a0transfer\u00a0or\u00a0state\u00a0interpretation\u00a0layer\u00a0in\u00a0HA.\n\n \t\tkerio_support_info_Slave.txt_3532751011141051113267111\n\n-\u00a0The\u00a0Kerio\u00a0Control\u00a0version\u00a0in\u00a0use\u00a0is\u00a09.5.0\u00a0patch\u00a03\u00a0build\u00a09017\u00a0(Software\u00a0Appliance).\n-\u00a0The\u00a0device\u00a0is\u00a0a\u00a0trial\u00a0installation\u00a0and\u00a0appears\u00a0to\u00a0be\u00a0running\u00a0in\u00a0a\u00a0virtualized\u00a0environment\u00a0(QEMU).\n-\u00a0The\u00a0HA\u00a0link\u00a0(eth2,\u00a010.0.0.2/24)\u00a0is\u00a0present\u00a0and\u00a0up,\u00a0and\u00a0interface\u00a0names\u00a0are\u00a0consistent\u00a0with\u00a0standard\u00a0HA\u00a0practice.\n-\u00a0Both\u00a0WAN\u00a0interfaces\u00a0(\u201cWAN\u201d\u00a0\u2013\u00a0eth0\u00a0and\u00a0\u201cEthernet\u00a02\u201d\u00a0\u2013\u00a0eth3)\u00a0are\u00a0configured,\u00a0both\u00a0have\u00a0DNS\u00a0servers\u00a0set,\u00a0but\u00a0no\u00a0explicit\u00a0IP\u00a0address/Mask\u00a0is\u00a0shown\u00a0in\u00a0the\u00a0support\u00a0file\u00a0for\u00a0\u201cWAN\u201d\u00a0or\u00a0\u201cEthernet\u00a02\u201d.\n-\u00a0The\u00a0debug\u00a0log\u00a0shows\u00a0the\u00a0following\u00a0sequence\u00a0on\u00a0the\u00a0Slave\u00a0during\u00a0HA\u00a0establishment:\n-\u00a0\u201cDisabling\u00a0internet\u00a0interfaces.\u201d\n-\u00a0\u201cDisabling\u00a0\u2018WAN\u2019\u00a0automatically\u00a0from\u00a0high\u00a0availability.\u201d\n-\u00a0\u201cDisabling\u00a0'Ethernet\u00a02\u2019\u00a0automatically\u00a0from\u00a0high\u00a0availability.\u201d\n-\u00a0This\u00a0corresponds\u00a0to\u00a0the\u00a0customer\u2019s\u00a0observation\u00a0that\u00a0the\u00a0WAN\u00a0links\u00a0on\u00a0the\u00a0Slave\u00a0are\u00a0set\u00a0to\u00a0DOWN\u00a0by\u00a0the\u00a0HA\u00a0process.\n-\u00a0Immediately\u00a0following\u00a0WAN\u00a0interfaces\u00a0being\u00a0set\u00a0to\u00a0DOWN\u00a0on\u00a0the\u00a0Slave,\u00a0no\u00a0information\u00a0about\u00a0Primary/Backup\u00a0flags\u00a0or\u00a0roles\u00a0for\u00a0WAN\u00a0interfaces\u00a0is\u00a0present\u00a0in\u00a0the\u00a0logs.\n-\u00a0The\u00a0log\u00a0lines:\u00a0\u201cInterface\u00a0\u2018WAN\u2019\u00a0will\u00a0prevent\u00a0adding\u00a0static\u00a0route\u201d\u00a0and\u00a0\u201cInterface\u00a0\u2018Ethernet\u00a02\u2019\u00a0will\u00a0prevent\u00a0adding\u00a0static\u00a0route\u201d\u00a0indicate\u00a0that\u00a0routing\u00a0for\u00a0these\u00a0interfaces\u00a0is\u00a0not\u00a0activated\u00a0at\u00a0this\u00a0stage\u00a0on\u00a0the\u00a0Slave,\u00a0reflecting\u00a0a\u00a0lack\u00a0of\u00a0routed\u00a0active/inactive\u00a0role\u00a0distinction.\n-\u00a0After\u00a0HA\u00a0sync/establishment,\u00a0subsequent\u00a0debug\u00a0and\u00a0routing\u00a0outputs\u00a0show\u00a0only\u00a0internal/HA\u00a0and\u00a0LAN/VPN\u00a0subnets,\u00a0with\u00a0no\u00a0default\u00a0route\u00a0(no\u00a0default\u00a0gateway\u00a0via\u00a0WAN\u00a0interfaces)\u00a0and\u00a0no\u00a0evidence\u00a0of\u00a0\u201cPrimary\u201d\u00a0or\u00a0\u201cBackup\u201d\u00a0WAN\u00a0role\u00a0status.\n-\u00a0The\u00a0system\u2019s\u00a0routing\u00a0table\u00a0after\u00a0HA\u00a0sync\u00a0lacks\u00a0any\u00a0default\u00a0(0.0.0.0/0)\u00a0gateway;\u00a0only\u00a0internal/HA\u00a0and\u00a0LAN/VPN\u00a0subnets\u00a0are\u00a0present,\u00a0supporting\u00a0the\u00a0observation\u00a0of\u00a0WAN\u00a0connectivity\u00a0loss\u00a0on\u00a0the\u00a0Slave\u00a0after\u00a0failover.\n-\u00a0There\u00a0are\u00a0log\u00a0entries\u00a0regarding\u00a0\u201cProblem\u00a0with\u00a0default\u00a0gateway\u201d,\u00a0matching\u00a0the\u00a0customer\u2019s\u00a0description\u00a0of\u00a0a\u00a0problem\u00a0with\u00a0the\u00a0Slave\u2019s\u00a0ability\u00a0to\u00a0set\u00a0up\u00a0a\u00a0proper\u00a0outbound\u00a0route\u00a0via\u00a0WAN\u00a0after\u00a0establishing\u00a0HA.\n-\u00a0The\u00a0\u201cMultiple\u00a0links\u00a0\u2013\u00a0Failover\u201d\u00a0configuration\u00a0mode\u00a0is\u00a0mentioned\u00a0by\u00a0the\u00a0customer\u00a0as\u00a0being\u00a0present,\u00a0but\u00a0the\u00a0system\u00a0does\u00a0not\u00a0show\u00a0evidence\u00a0in\u00a0routing\u00a0or\u00a0debug\u00a0outputs\u00a0about\u00a0any\u00a0remaining\u00a0\u201cPrimary/Backup\u201d\u00a0roles\u00a0for\u00a0the\u00a0WAN\u00a0links\u00a0on\u00a0the\u00a0Slave,\u00a0only\u00a0that\u00a0they\u00a0are\u00a0Down/disabled.\n-\u00a0There\u00a0is\u00a0nothing\u00a0in\u00a0the\u00a0support_info\u00a0showing\u00a0a\u00a0\u201chandover\u201d\u00a0or\u00a0preservation\u00a0of\u00a0WAN\u00a0interface\u00a0roles\u00a0(Primary/Backup)\u00a0across\u00a0the\u00a0HA\u00a0interface\u00a0synchronization\u00a0process;\u00a0instead,\u00a0the\u00a0process\u00a0disables\u00a0both\u00a0WAN\u00a0interfaces\u00a0on\u00a0the\u00a0Slave\u00a0and\u00a0omits\u00a0their\u00a0role\u00a0designation\u00a0in\u00a0subsequent\u00a0operation.\n-\u00a0The\u00a0logs\u00a0do\u00a0show\u00a0configuration\u00a0merge\u00a0events\u00a0(winroute.cfg)\u00a0from\u00a0the\u00a0HA\u00a0Master\u00a0but\u00a0no\u00a0log\u00a0entries\u00a0specific\u00a0to\u00a0WAN\u00a0role\u00a0status\u00a0transfer.\n-\u00a0No\u00a0errors\u00a0directly\u00a0mention\u00a0WAN\u00a0interface\u00a0role\u00a0failover\u00a0or\u00a0restoration;\u00a0the\u00a0HA\u00a0mechanism\u00a0appears\u00a0to\u00a0treat\u00a0the\u00a0interfaces\u00a0as\u00a0generic\u00a0internet\u00a0interfaces\u00a0and\u00a0only\u00a0disables\u00a0them\u00a0on\u00a0the\u00a0Slave.\n-\u00a0The\u00a0observed\u00a0behavior\u00a0is\u00a0consistent\u00a0with\u00a0the\u00a0reported\u00a0issue:\u00a0after\u00a0HA\u00a0synchronization,\u00a0WAN\u00a0links\u00a0on\u00a0the\u00a0Slave\u00a0lose\u00a0both\u00a0carrier\u00a0status\u00a0(set\u00a0down/disabled)\u00a0and\u00a0Primary/Backup\u00a0role\u00a0information.\n-\u00a0The\u00a0specific\u00a0support_info\u00a0does\u00a0not\u00a0show\u00a0any\u00a0manual\u00a0or\u00a0automated\u00a0recovery\u00a0or\u00a0restoration\u00a0of\u00a0WAN\u00a0role\u00a0status\u00a0post-synchronization,\u00a0nor\u00a0any\u00a0attempt\u00a0to\u00a0bring\u00a0the\u00a0links\u00a0up\u00a0with\u00a0original\u00a0role\u00a0designations.\n\n \t\tMaster HA status.png_1378078711310261000\n\n-\u00a0The\u00a0High\u00a0Availability\u00a0mode\u00a0is\u00a0set\u00a0to\u00a0Active/Passive.\n-\u00a0The\u00a0current\u00a0device\u00a0is\u00a0configured\u00a0as\u00a0the\u00a0Master.\n-\u00a0Sync/Status\u00a0Interface\u00a0is\u00a0set\u00a0to\u00a0HA.\n-\u00a0Both\u00a0Status\u00a0and\u00a0Health\u00a0Check\u00a0are\u00a0showing\u00a0OK\u00a0and\u00a0Successful,\u00a0indicating\u00a0proper\u00a0communication\u00a0and\u00a0functioning\u00a0of\u00a0HA\u00a0in\u00a0this\u00a0state.\n-\u00a0Four\u00a0interfaces\u00a0are\u00a0listed\u00a0under\u00a0High\u00a0Availability:\u00a0Ethernet\u00a0(eth1),\u00a0Ethernet\u00a02\u00a0(eth3),\u00a0HA\u00a0(eth2),\u00a0and\u00a0WAN\u00a0(eth0).\n-\u00a0Each\u00a0interface\u00a0has\u00a0an\u00a0assigned\u00a0IPv4\u00a0address\u00a0and,\u00a0where\u00a0applicable,\u00a0a\u00a0Virtual\u00a0IPv4\u00a0address\u00a0for\u00a0HA.\n-\u00a0The\u00a0WAN\u00a0interface\u00a0(eth0)\u00a0is\u00a0configured\u00a0with\u00a0IPv4\u00a0address\u00a0192.168.150.160.\n-\u00a0The\u00a0screenshot\u00a0was\u00a0taken\u00a0from\u00a0the\u00a0IP\u00a0address\u00a010.10.10.2,\u00a0which\u00a0is\u00a0typically\u00a0not\u00a0a\u00a0public\u00a0IP\u00a0and\u00a0indicates\u00a0a\u00a0test\u00a0or\u00a0internal\u00a0network\u00a0environment.\n-\u00a0The\u00a0web\u00a0interface\u00a0is\u00a0accessed\u00a0via\u00a0HTTPS\u00a0but\u00a0is\u00a0marked\u00a0Niezabezpieczona\u00a0(Not\u00a0Secure),\u00a0implying\u00a0an\u00a0insecure\u00a0or\u00a0untrusted\u00a0SSL\u00a0certificate.\n-\u00a0The\u00a0roles\u00a0of\u00a0Primary/Backup\u00a0on\u00a0WAN\u00a0interfaces\u00a0are\u00a0not\u00a0visible\u00a0or\u00a0shown\u00a0in\u00a0the\u00a0provided\u00a0screenshot,\u00a0though\u00a0this\u00a0information\u00a0is\u00a0critical\u00a0to\u00a0the\u00a0user's\u00a0reported\u00a0problem.\n\n \t\tMaster Interfaces.png_1378078711310261000\n\n-\u00a0The\u00a0screenshot\u00a0is\u00a0from\u00a0the\u00a0PRIMARY\u00a0device\u2019s\u00a0admin\u00a0interface\u00a0in\u00a0Kerio\u00a0Control.\n-\u00a0The\u00a0interface\u00a0for\u00a0admin\u00a0access\u00a0is\u00a0marked\u00a0as\u00a0\u201cNiezabezpieczona\u201d\u00a0(Not\u00a0Secure),\u00a0indicating\u00a0the\u00a0session\u00a0is\u00a0not\u00a0encrypted.\n-\u00a0HA\u00a0(High\u00a0Availability)\u00a0is\u00a0configured\u00a0and\u00a0its\u00a0status\u00a0is\u00a0OK\u00a0(green),\u00a0with\u00a0the\u00a0HA\u00a0interface\u00a0(10.0.0.1)\u00a0in\u00a0the\u00a0\u201cUp\u201d\u00a0state.\n-\u00a0The\u00a0Internet\u00a0connection\u00a0mode\u00a0is\u00a0set\u00a0to\u00a0\u201cMultiple\u00a0Internet\u00a0Links\u00a0-\u00a0Failover.\u201d\n-\u00a0Two\u00a0Internet\u00a0Interfaces\u00a0are\u00a0configured:\u00a0\u201cEthernet\u00a02\u201d\u00a0(IP:\u00a0192.168.9.160)\u00a0and\u00a0\u201cWAN\u201d\u00a0(IP:\u00a0192.168.150.160),\u00a0both\u00a0are\u00a0\u201cUp.\u201d\n-\u00a0The\u00a0\u201cConnectivity\u201d\u00a0column\u00a0shows\u00a0one\u00a0WAN\u00a0link\u00a0assigned\u00a0as\u00a0Primary\u00a0and\u00a0one\u00a0as\u00a0Backup.\n-\u00a0There\u00a0is\u00a0a\u00a0VPN\u00a0server\u00a0interface\u00a0(OpenVPN\u00a0Server)\u00a0listed\u00a0but\u00a0it\u00a0is\u00a0\u201cDown.\u201d\n-\u00a0The\u00a0Primary/Backup\u00a0designation\u00a0for\u00a0WAN\u00a0links\u00a0is\u00a0correctly\u00a0visible/set\u00a0on\u00a0this\u00a0PRIMARY\u00a0device.\n\n \t\tSlave - after HA failover.png_1378078711310261000\n\n-\u00a0The\u00a0Internet\u00a0connectivity\u00a0setting\u00a0is\u00a0configured\u00a0as\u00a0Multiple\u00a0Internet\u00a0Links\u00a0-\u00a0Failover.\n-\u00a0Both\u00a0WAN\u00a0interfaces\u00a0(Ethernet\u00a02\u00a0and\u00a0WAN)\u00a0are\u00a0in\u00a0the\u00a0Up\u00a0status.\n-\u00a0There\u00a0are\u00a0no\u00a0visual\u00a0indicators\u00a0or\u00a0flags\u00a0showing\u00a0Primary/Backup\u00a0roles\u00a0for\u00a0either\u00a0WAN\u00a0interface.\n-\u00a0A\u00a0warning\u00a0message\u00a0Problem\u00a0with\u00a0default\u00a0gateway\u00a0is\u00a0displayed\u00a0in\u00a0the\u00a0upper\u00a0right\u00a0corner.\n-\u00a0The\u00a0VPN\u00a0interface\u00a0(OpenVPN\u00a0Server)\u00a0is\u00a0down\u00a0and\u00a0the\u00a0server\u00a0is\u00a0disabled.\n-\u00a0The\u00a0system\u00a0is\u00a0being\u00a0accessed\u00a0via\u00a0an\u00a0unencrypted\u00a0(not\u00a0secure)\u00a0connection,\u00a0as\u00a0indicated\u00a0by\u00a0the\u00a0Niezabezpieczona\u00a0warning\u00a0in\u00a0the\u00a0browser\u00a0and\u00a0the\u00a0https\u00a0with\u00a0a\u00a0warning\u00a0icon.\n-\u00a0The\u00a0HA\u00a0interface\u00a0(10.0.0.2)\u00a0is\u00a0up\u00a0and\u00a0IPv6\u00a0is\u00a0disabled.\n-\u00a0The\u00a0details\u00a0and\u00a0configuration\u00a0do\u00a0not\u00a0display\u00a0any\u00a0differentiation\u00a0or\u00a0designation\u00a0of\u00a0WAN\u00a0links\u00a0as\u00a0Primary\u00a0or\u00a0Backup,\u00a0despite\u00a0failover\u00a0mode\u00a0being\u00a0enabled.\n\n \t\tSlave HA.png_1378078711310261000\n\n-\u00a0The\u00a0Kerio\u00a0Control\u00a0device\u00a0is\u00a0operating\u00a0in\u00a0High\u00a0Availability\u00a0mode\u00a0with\u00a0the\u00a0Instance\u00a0Mode\u00a0set\u00a0to\u00a0Slave.\n-\u00a0The\u00a0HA\u00a0status\u00a0is\u00a0OK\u00a0and\u00a0the\u00a0Health\u00a0Check\u00a0is\u00a0Successful,\u00a0indicating\u00a0normal\u00a0HA\u00a0function\u00a0at\u00a0the\u00a0system\u00a0level.\n-\u00a0The\u00a0device\u00a0name\u00a0is\u00a0Control2\u00a0and\u00a0the\u00a0designated\u00a0Sync/Status\u00a0Interface\u00a0is\u00a0HA.\n-\u00a0Under\u00a0Interfaces,\u00a0there\u00a0are\u00a0four\u00a0listed:\u00a0Ethernet\u00a0(eth1),\u00a0Ethernet\u00a02\u00a0(eth3),\u00a0HA\u00a0(eth2),\u00a0and\u00a0WAN\u00a0(eth0).\n-\u00a0The\u00a0interface\u00a0table\u00a0shows\u00a0configuration\u00a0details\u00a0(IPv4,\u00a0Virtual\u00a0IPv4\u00a0addresses),\u00a0but\u00a0does\u00a0not\u00a0indicate\u00a0any\u00a0Primary\u00a0or\u00a0Backup\u00a0flags\u00a0for\u00a0WAN\u00a0interfaces.\n-\u00a0There\u00a0is\u00a0no\u00a0visual\u00a0indication\u00a0or\u00a0flag\u00a0for\u00a0Primary\u00a0or\u00a0Backup\u00a0status\u00a0for\u00a0the\u00a0WAN\u00a0link\u00a0(eth0)\u00a0on\u00a0the\u00a0Slave\u00a0device\u00a0interface\u00a0listing.\n-\u00a0The\u00a0browser\u00a0connection\u00a0to\u00a0the\u00a0admin\u00a0interface\u00a0is\u00a0marked\u00a0as\u00a0Not\u00a0Secure\u00a0(Niezabezpieczona),\u00a0indicating\u00a0usage\u00a0of\u00a0HTTP\u00a0or\u00a0an\u00a0invalid\u00a0HTTPS\u00a0certificate.\n\n \t\tSlave Interfaces.png_1378078711310261000\n\n-\u00a0The\u00a0Slave\u00a0device\u00a0is\u00a0operating\u00a0in\u00a0High\u00a0Availability\u00a0(HA)\u00a0mode\u00a0with\u00a0status\u00a0Up\u00a0and\u00a0\u201cStatus\u00a0OK\u201d.\n-\u00a0The\u00a0Internet\u00a0connectivity\u00a0option\u00a0is\u00a0set\u00a0to\u00a0Multiple\u00a0Internet\u00a0Links\u00a0-\u00a0Failover.\n-\u00a0Both\u00a0WAN\u00a0interfaces\u00a0(Ethernet\u00a02\u00a0and\u00a0WAN)\u00a0are\u00a0in\u00a0a\u00a0Down\u00a0state.\n-\u00a0Both\u00a0WAN\u00a0interfaces\u00a0are\u00a0missing\u00a0the\u00a0Primary/Backup\u00a0designation\u00a0flags.\n-\u00a0The\u00a0interface\u00a0list\u00a0only\u00a0shows\u00a0status\u00a0Down\u00a0and\u00a0lacks\u00a0any\u00a0indication\u00a0which\u00a0link\u00a0is\u00a0Primary\u00a0and\u00a0which\u00a0is\u00a0Backup.\n-\u00a0The\u00a0HA\u00a0interface\u00a0(10.0.0.2)\u00a0is\u00a0up\u00a0and\u00a0IPv6\u00a0is\u00a0disabled\u00a0on\u00a0all\u00a0interfaces.\n-\u00a0The\u00a0web\u00a0interface\u00a0is\u00a0being\u00a0accessed\u00a0over\u00a0an\u00a0unsecured\u00a0(HTTP)\u00a0connection\u00a0as\u00a0indicated\u00a0by\u00a0Niezabezpieczona.\n-\u00a0The\u00a0screenshot\u00a0is\u00a0from\u00a0the\u00a0Slave\u00a0device\u00a0after\u00a0failover\u00a0with\u00a0no\u00a0active\u00a0WAN\u00a0connectivity\u00a0and\u00a0no\u00a0role\u00a0flags\u00a0assigned\u00a0to\u00a0either\u00a0link.\n\n \t\twarning.log.txt_9150564765117103475048\n\n-\u00a0The\u00a0log\u00a0shows\u00a0multiple\u00a0entries\u00a0indicating\u00a0There\u00a0is\u00a0no\u00a0valid\u00a0license\u00a0for\u00a0the\u00a0product!\u00a0on\u00a0[28/Aug/2025\u00a011:42:03].\n-\u00a0Several\u00a0logs\u00a0indicate\u00a0the\u00a0system\u00a0RAM\u00a0size\u00a0is\u00a01995MB,\u00a0with\u00a0a\u00a0recommendation\u00a0to\u00a0expand\u00a0to\u00a0at\u00a0least\u00a02096MB\u00a0for\u00a0better\u00a0IPS\u00a0performance.\u00a0This\u00a0low\u00a0memory\u00a0condition\u00a0could\u00a0potentially\u00a0influence\u00a0system\u00a0behavior\u00a0or\u00a0HA\u00a0failover\u00a0performance.\n-\u00a0There\u00a0are\u00a0no\u00a0log\u00a0entries\u00a0directly\u00a0mentioning\u00a0HA\u00a0events,\u00a0interface\u00a0flag\u00a0changes,\u00a0WAN\u00a0link\u00a0state,\u00a0or\u00a0errors\u00a0directly\u00a0tied\u00a0to\u00a0Primary/Backup\u00a0status\u00a0on\u00a0interfaces.\n\n"
        ],
        [
          "2025-09-16T08:27:38+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello.\n\nCould I kindly ask for an update? The customer is waiting for information on whether they will be able to activate HA or they will have to wait for fixes that will eliminate the incorrect transfer of WAN link configurations when Internet connection failover is used.\n\nThanks.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: Hermes (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 15-09-2025 14:52\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\nYou are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update:\n\nDear Slawomir,\n\nThank you for sharing the video from your test environment and providing further details about the behavior you are observing with the Primary/Backup flags on the Slave device during the HA establishment process.\n\nWe appreciate the effort you have taken to document your setup and observations. Your input will be carefully reviewed to better understand the situation and determine the most appropriate next steps.\n\nIf you have any additional information or observations, please feel free to share them with us.\n\nSincerely,\nHermes\nGFI - Kerio Control Support Team\n\nSent with Kayako [https://kayako.com]image \n"
        ],
        [
          "2025-09-15T09:50:34+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello.\n\nPlease find attached a video from my test environment. In the video, you can see how the HA establishment process causes a loss of Primary/Backup flags on the WAN links of the Slave device.\n\nRegards.\nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/]\nSun Capital sp. z o.o.\nPOLAND\n\nimage\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: Hermes (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 13-09-2025 18:22\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\nYou are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update:\n\nDear Slawomir,\n\nThank you for sharing the screenshots and providing additional details about your High Availability configuration. We understand your observations regarding the missing Primary/Backup flags on the Slave device after failover, and we appreciate the clarity you have provided about your setup.\n\nYour input will be carefully reviewed to better understand the situation and determine the most appropriate next steps. If you have any further information or observations, please feel free to share them with us.\n\nSincerely,\nHermes\nGFI - Kerio Control Support Team\n\nSent with Kayako [https://kayako.com]image \n"
        ],
        [
          "2025-09-13T13:21:43+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented publicly: Hello.\n\u00a0\nPlease find attached screenshots.\n\u00a0\nYou can see that after HA failover, Slave device has Internet Connection set to Multiple Links - Failover, but there are lack of Primary/Backup flags. When setting HA, both devices were configured identically - Both WAN links had the same IP addresses and identically configured role Primary / Backup.\n\u00a0\nWhen establishing HA, both WAN links on Slave device are set to DOWN (correct) but the same time both links lose Primary / Backup flags.\n\nRegards. \nSlawek Burak \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 \u00a0 Linked-In [https://www.linkedin.com/in/slawomir-burak/] \nSun Capital sp. z o.o. \nPOLAND \n\n image\n\n----- Wiadomo\u015b\u0107 oryginalna -----\n-------------------------\n\nOd: Zubair Farooq (KerioControl) (customersupport-keriocontrol@gfi.com)\nData: 13-09-2025 15:08\nDo: Slawomir Burak (slawek@suncapital.pl)\nTemat: Re: HA Configuration Issue: Missing Flags on Slave Device\n\nYou are receiving this email because request [#60196166] [https://support.keriocontrol.gfi.com/conversation/view/60196166] has received the below update:\n\nDear Slawomir,\n\nThank you for contacting the Kerio Control Support Team. I understand that you are using 2 internet connections on configured High Availability devices.\n\nKindly note that when trying to configure High availability mode between hardware boxes with two Internet connections, it requires a specific setup. It includes port and switch configuration to connect Kerio Control boxes with each other.\n\nYou can see the details in Configure High Availability with 2 Internet connections [https://support.keriocontrol.gfi.com/article/116360-configure-high-availability-with-2-internet-connections]. Please remember that Master and Slave version should be the same, both should have the same number of interfaces and their names configured, same admin credentials set.\n\nIf the issue is still not resolved, please send us the screenshots of the configuration so we can investigate the issue.\n\nBest Regards,\nZubair Farooq\nGFI - Kerio Control Support Team\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you.\n\nSent with Kayako [https://kayako.com]image \n"
        ],
        [
          "2025-09-13T13:08:12+00:00",
          "Kayako - ticket id 60196166 // Zubair Farooq commented publicly: Dear Slawomir,\n\nThank you for contacting the Kerio Control Support Team. I understand that you are using 2 internet connections on configured High Availability devices.\n\nKindly note that when trying to configure High availability mode between hardware boxes with two Internet connections, it requires a specific setup. It includes port and switch configuration to connect Kerio Control boxes with each other.\n\nYou can see the details in Configure High Availability with 2 Internet connections [https://support.keriocontrol.gfi.com/article/116360-configure-high-availability-with-2-internet-connections]. Please remember that Master and Slave version should be the same, both should have the same number of interfaces and their names configured, same admin credentials set.\n\nIf the issue is still not resolved, please send us the screenshots of the configuration so we can investigate the issue.\n\nBest Regards,\nZubair Farooq\nGFI - Kerio Control Support Team\n\nThis ticket will stay open for one week unless you reply with \"This ticket can be closed\" or update the status to Completed in the portal. We will write to you again to remind you."
        ],
        [
          "2025-09-12T07:32:02+00:00",
          "Kayako - ticket id 60196166 // Slawomir Burak commented privately: Please find out a Support Info files from my test setup."
        ],
        [
          "2025-09-12T07:14:08+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented privately: Here is a transcript of the customer's recent interaction with ATLAS chat:\n\nChat Support:\n\n Hi, Slawomir Burak ! \ud83d\udc4b\n\nThis is the Kerio Control ATLAS support chat.\n\n-------------------------\n\n Please note: ATLAS is very smart and helpful, but like any GenAI assistant, he may provide incorrect responses from time to time. By chatting with him, you're agreeing to these terms and conditions [https://chatbotterms.trilogy.com/].\nIf you're unable to find a solution through our interaction, you will be guided through the steps to get additional support. \nSlawomir Burak:\n\n undefined \nChat Support:\n\n Please select from the below or give me a detailed description of what\u2019s happening. Any error messages you\u2019ve seen or steps you\u2019ve already tried would be really helpful.\n\ud83d\udca1Getting the most out of Kerio Control ATLAS Support Chat [https://support.keriocontrol.gfi.com/article/117054]\n\ud83d\udca1Tip: Aim to give us a bit more context than just a quick It's not working. The more specific you can be, the faster we can get to a solution! \ud83d\udd75\ufe0f\u200d\u2640\ufe0f\ud83d\udee0\ufe0f\nIf I'm not able to resolve your issue, I can connect you with one of our support specialists who will have all the information from our conversation, so you won't need to repeat yourself. \ud83d\udcaa \nSlawomir Burak:\n\n I want to talk to Tech support \nChat Support:\n\n I have this license key on record:\n- License: 20339-ZZXA2-561AE\n- Expiry date: 2026-05-30.\n\nJust to make sure we're on the same page - is this the same system you're reaching out about today?\n\n\ud83d\udca1It's important to have to correct license file, as it could influence the resolution. \nSlawomir Burak:\n\n No \nChat Support:\n\n Please provide me with your Kerio Control license key.\n(Trial license keys are also accepted, but in the case of trial licenses, please make sure to wait for at least 1 hour after obtaining it before contacting us).\n\n\u2753Don't know where to get the license key from? Check the resource below \ud83d\udc47\n\u2753 How to Obtain Your GFI License Key [https://support.gfi.com/article/109025-obtaining-your-gfi-license-key] \nSlawomir Burak:\n\n 20339-77MKN-ZIFC1 \nChat Support:\n\n Checking the validity of this license key: 20339-77MKN-ZIFC1 ... \nChat Support:\n\n \u2728 Good news, you've got a valid license, which is due to expire at: 2027-02-21.\n\nNow that we're done with the formalities, let's start troubleshooting! \nChat Support:\n\n If you have any \ud83d\udcc3 log files or \ud83d\uddbc\ufe0f screenshots to upload to help with the troubleshooting, now is the time to do it \ud83d\udcaa\n\n\u2139\ufe0f When you select to upload files, a new window will open to our secure portal allowing you to upload the attachments.\n\n\u2139\ufe0f When you are done uploading files, come back to this window to continue the flow.\n\n\ud83d\udca1 Depending on the size and filetype you upload, the analysis may take some time.\n\n\u2139\ufe0f In case it doesn't automatically open, here is the direct URL for it:\n\ud83d\udc49 Secure File Upload [https://files.eswsecuretransfers.com/customers?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uX3V1aWQiOiIyNmE3ZjI5NC0wYzhlLTQ4NTItYjY5ZS1mMTMyN2U1MjYxNTUiLCJzZXNzaW9uX3VpZCI6IjI2YTdmMjk0LTBjOGUtNDg1Mi1iNjllLWYxMzI3ZTUyNjE1NSIsImVtYWlsIjoic2xhd2VrQHN1bmNhcGl0YWwucGwiLCJjdXN0b21fcGFyc2VyIjp7fSwiY2FsbGJhY2siOnsiY2FsbGJhY2tfdXJsIjpudWxsLCJjYWxsYmFja19lbWFpbCI6ImNpcHJpYW4ubmFzdGFzZUB0cmlsb2d5LmNvbSJ9LCJwcm9kdWN0X3RhZyI6ImF1cmVhX2tlcmlvX2NvbnRyb2wiLCJxdWVyeSI6IiIsImV4cCI6MTc1NzY2NjMyMH0.ml7N5hPAMcIZc8sm57GwuQ36FTGOXHHqlLMI3mLoHdE]\n\nYou should see the following:\n- User: slawek@suncapital.pl\n- Session ID: 26a7f294-0c8e-4852-b69e-f1327e526155 \nSlawomir Burak:\n\n \ud83d\udcce I want to upload files \nChat Support:\n\n I've received and analyzed your uploaded files\u2014thanks for providing those! Here\u2019s a summary of what I found based on the screenshots and configuration details:\n\nKEY OBSERVATIONS & RECOMMENDATIONS\n\n1. High Availability (HA) Configuration\n- Your Kerio Control is set up in Active/Passive HA mode, with both Master and Slave devices showing \u201cStatus: OK\u201d and \u201cHealth Check: Successful.\u201d This means your HA setup is currently working as intended.\n- The interfaces (Ethernet, WAN, HA) are configured with appropriate IP addresses and virtual IPs for failover.\n\n2. Network Interfaces\n- Both primary and backup internet links are marked as \u201cUp,\u201d which is good for redundancy.\n- The VPN server interface is \u201cDown.\u201d If you require VPN functionality, you\u2019ll want to investigate and resolve this.\n\n3. Security Concerns\n- The browser shows \u201cNiezabezpieczona\u201d (\u201cNot Secure\u201d), indicating the admin interface is being accessed over an unencrypted connection. This is a security risk.\n- Recommendation: Secure your admin interface with HTTPS and a valid SSL certificate to protect your credentials and configuration data.\n\n4. IPv6\n- IPv6 is disabled on all interfaces. If your network or ISP requires IPv6, consider enabling and configuring it.\n\n5. Shared Secret\n- The shared secret for HA is set (obscured in the screenshot). Make sure it\u2019s strong and securely stored.\n\n-------------------------\n\nNEXT STEPS\n\n- Would you like step-by-step guidance on securing your admin interface with HTTPS?\n- Do you need help troubleshooting the VPN server status?\n- Or is there another specific issue you\u2019d like to focus on?\n\nLet me know which area you\u2019d like to address first, or if you have any other questions about your Kerio Control setup! \nSlawomir Burak:\n\n I need to help with missing Primary / Backup flags on Slave Device. After Failover (changing primary and secondary device), WAN links not working as expected. \nChat Support:\n\n Thanks for explaining your issue with the missing Primary/Backup flags on the Slave device after a failover, and the WAN links not working as expected. This is a known area of complexity in Kerio Control's High Availability (HA) setup.\n\nHere\u2019s what I found that\u2019s relevant to your situation:\n\n-------------------------\n\nKEY POINTS FROM THE KNOWLEDGE BASE\n\n- In Kerio Control HA, the Master device manages the virtual IP and the WAN interfaces. When a failover occurs, the Slave should take over the virtual IP and activate its WAN interfaces.\n- If both Master and Slave have the same WAN IP, only the active device (the one with the virtual IP) will have its WAN interface enabled. The other device\u2019s WAN interface will be disabled automatically by HA.\n- After failover, the Slave (now acting as Master) should show the correct Primary/Backup flags, and WAN links should become active. If this does not happen, it may indicate a synchronization or configuration issue.\n\nYou can review more details in these articles:\n- Configuring High Availability in Kerio Control [https://support.keriocontrol.gfi.com/article/116372]\n- High Availability (HA) Status and Health Check messages [https://support.keriocontrol.gfi.com/article/116366]\n- Kerio Control High Availability (HA) Special cases [https://support.keriocontrol.gfi.com/article/116379]\n\n-------------------------\n\nTO HELP TROUBLESHOOT FURTHER\n\nCould you please provide the following information?\n1. Have you made any recent changes to the network interface configuration or HA settings before the issue started?\n2. Are both devices using the same WAN IP, or do they have separate IPs?\n3. After failover, does the Slave device show any error or warning messages in the logs?\n4. Have you tried rebooting both devices or reinitializing the HA setup?\n5. If possible, could you share screenshots or logs from both the Master and Slave after the failover event?\n\nThis information will help pinpoint whether the issue is with interface configuration, HA synchronization, or something else.\n\nLet me know, and I\u2019ll guide you step-by-step based on your answers! \nSlawomir Burak:\n\n 1. This is fresh HA configuration.\n2. Both uses the same WAN IPs.\n3. Slave device shows message on Dashbord: Problem with default gateway, wich is caused by missig primary/backup flag on WAN links\n4. Yes - it didn't help.\n5. Sure - I can upload a screenshot from Slave device. From Mater device I can't because when test failover scenario, I powering off Master. \nChat Support:\n\n Thank you for the detailed answers\u2014this really helps narrow things down. Here\u2019s a summary of what\u2019s happening and some next steps:\n\n-------------------------\n\nWHAT\u2019S HAPPENING\n\n- You have a fresh HA setup, both devices use the same WAN IPs (which is supported in Kerio Control HA).\n- After failover (Master powered off), the Slave becomes active, but the Primary/Backup flags are missing on WAN links, and you see a \u201cProblem with default gateway\u201d message on the Slave\u2019s dashboard.\n- Rebooting/reinitializing HA didn\u2019t resolve the issue.\n- You can provide a screenshot from the Slave, but not from the Master during failover (which is expected).\n\n-------------------------\n\nWHY THIS HAPPENS\n\nAccording to the Kerio Control documentation:\n- When both devices use the same WAN IP, only the active device should have its WAN interface enabled. The Slave\u2019s WAN interface is disabled while the Master is running, and should be enabled when the Slave takes over.\n- The \u201cPrimary/Backup\u201d flags are essential for correct failover routing. If these flags are missing after failover, the Slave may not know which WAN interface to use as the default gateway, causing the error you see.\n\nThis behavior can sometimes be caused by:\n- Incomplete HA synchronization.\n- A bug or misconfiguration in the HA or interface settings.\n- Issues with the virtual IP assignment or interface mapping.\n\n-------------------------\n\nNEXT STEPS\n\n1. Please upload the screenshot from the Slave device\u2019s dashboard showing the error and the interface configuration. This will help confirm the state of the flags and interfaces.\n2. If possible, also export and upload the Error and Warning logs from the Slave device (after failover). This can provide more insight into what\u2019s happening behind the scenes.\n- Guidance for extracting logs: Kerio Control Logs Overview [https://support.keriocontrol.gfi.com/hc/en-us/articles/360015181460-Kerio-Control-Logs-Overview]\n\nOnce I have the screenshot and/or logs, I\u2019ll review them and provide targeted troubleshooting steps. If the issue appears to be a product bug or something that can\u2019t be resolved through configuration, I\u2019ll guide you on the next steps for escalation.\n\nLet me know once you\u2019ve uploaded the screenshot or if you need help with the log export process! \nSlawomir Burak:\n\n Files have been uploaded succesfully \nChat Support:\n\n Thanks for your patience! I\u2019ve reviewed the analysis of your uploaded logs and screenshots. Here\u2019s a summary of what\u2019s happening and some targeted recommendations:\n\n-------------------------\n\nKEY FINDINGS FROM YOUR FILES\n\n1. Default Gateway Problem & Missing Primary/Backup Flags\n- The screenshot confirms the \u201cProblem with default gateway\u201d warning on the Slave device.\n- Both internet-facing interfaces (\u201cEthernet 2\u201d and \u201cWAN\u201d) are down on the Slave after failover, and the Primary/Backup flags are missing. This is why the Slave can\u2019t establish a default gateway, causing WAN connectivity to fail.\n\n2. High Availability (HA) Status\n- The HA configuration itself is marked as \u201cOK\u201d and \u201cSuccessful\u201d in health checks, so the basic HA sync is working.\n- Both Master and Slave are configured with the same WAN IPs, which is supported, but only the active device should have its WAN interfaces enabled.\n\n3. Other Observations\n- There are warnings about running without a valid license and insufficient RAM (below 2GB), which could impact system performance and some features.\n- DNS query failures and product update errors are present, likely due to the default gateway issue after failover.\n- The admin interface is accessed over an unsecured (HTTP) connection\u2014this is a security risk.\n\n-------------------------\n\nRECOMMENDATIONS & NEXT STEPS\n\n1. ADDRESS THE DEFAULT GATEWAY & INTERFACE FLAGS\n\n- The missing Primary/Backup flags and both WAN interfaces being down on the Slave indicate a possible bug or misconfiguration in the HA failover process.\n- Double-check that the interface mapping and virtual IP assignments are identical on both Master and Slave.\n- Make sure the \u201cMultiple Internet Links \u2013 Failover\u201d configuration is set up exactly the same on both devices, and that the interface names and roles (Primary/Backup) match.\n- If you recently changed interface names or order, try re-creating the HA configuration from scratch, ensuring both devices have identical interface setups before enabling HA.\n\n2. LICENSING & HARDWARE\n\n- The system is running without a valid license. Please renew or reactivate your Kerio Control license to ensure full functionality.\n- The RAM is below the recommended minimum for optimal performance. If possible, upgrade to at least 2GB.\n\n3. SECURITY & CONNECTIVITY\n\n- Access the admin interface using HTTPS to secure your management sessions.\n- Review DNS and product update settings once the default gateway issue is resolved.\n\n4. IF THE ISSUE PERSISTS\n\n- This behavior (missing flags and both WAN interfaces down after failover) is not expected in a healthy HA setup. If you\u2019ve confirmed the above and the issue remains, it may require escalation for deeper investigation.\n\n-------------------------\n\nWOULD YOU LIKE TO:\n\n- Try re-creating the HA configuration with careful interface mapping?\n- Get step-by-step guidance for any of the above actions?\n- Or would you prefer to escalate this to a live support agent for further investigation?\n\nLet me know how you\u2019d like to proceed! \nChat Support:\n\n I understand your concern about a potential bug in the HA configuration. \ud83d\ude0a A human support engineer will be available to assist you further\u2014please feel free to choose from the available options to connect with them. \nSlawomir Burak:\n\n \ud83d\udce9 Raise a ticket \nChat Support:\n\n Please provide any other additional details we might need to investigate and resolve your issue.\n\n\ud83d\udca1 If the reported behavior affects multiple end-customers, please do let us know the impact radius of the issue.\n\nYou can use Shift+Enter if you want to continue typing in a new line.\n\nFor now, I am unable to take any file uploads, so any relevant log files or attachments can be provided directly in the ticket once I create it for you.\n\n Please note: the ticket will get created only after you provide the above requested information or after a 5-minute timeout. \nSlawomir Burak:\n\n This problem at the moment affects only one customer - UM Lubin (20339-77MKN-ZIFC1), beacause probably no more customers use HA with WAN link failover. \nChat Support:\n\n If you want to add additional \ud83d\udce7 email addresses in the ticket CC, please specify them below.\n\nYou can specify multiple email addresses, separated by a comma (for example: test@example.com, test2@example.com)\n\nOtherwise, just click the button \ud83d\udc47 \nSlawomir Burak:\n\n No additional email addresses required in CC \nChat Support:\n\n I'm creating a ticket for you with the information you've provided.\n\nTicket subject: HA Configuration Issue: Missing Flags on Slave Device\n\nAllow me a few moments while I work on this \u23f3 \nChat Support:\n\n \ud83d\ude80 I've successfully created a ticket for you.\n\nYour ticket number is: 60196166\n\nYou can see it and update it in this link [https://support.keriocontrol.gfi.com/conversation/view/60196166]\n\nFor a faster resolution, please be sure to include and attach to the ticket all relevant context such as screenshots, recordings, and logs.\n\nOur agents will work on it and you will receive a response in your email \ud83d\udce8: slawek@suncapital.pl "
        ],
        [
          "2025-09-12T07:14:02+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented privately: **Customer interacted with ATLAS-UPLOAD system during their ATLAS-chat interaction, which means that they may have uploaded some files for AI analysis.** Please login to UPLOAD using your Devfactory AD credentials to verify: https://files.eswsecuretransfers.com/agents/?user_id=slawek@suncapital.pl&session_uuid=26a7f294-0c8e-4852-b69e-f1327e526155"
        ],
        [
          "2025-09-12T07:13:56+00:00",
          "Kayako - ticket id 60196166 // ATLAS commented privately: --- Ticket generated by Kerio Control AI chat on behalf of Slawomir Burak ---<br>\n  <br>\n  <b>Issue description:</b><br>\n  * I want to talk to Tech support<br>\n  * I need to help with missing Primary / Backup flags on Slave Device. After Failover (changing primary and secondary device), WAN links not working as expected.<br>\n  * 1. This is fresh HA configuration.<br>\n  2. Both uses the same WAN IPs.<br>\n  3. Slave device shows message on Dashbord: Problem with default gateway, wich is caused by missig primary/backup flag on WAN links<br>\n  4. Yes - it didn't help.<br>\n  5. Sure - I can upload a screenshot from Slave device. From Mater device I can't because when test failover scenario, I powering off Master.<br>\n  * Files have been uploaded succesfully<br>\n  * I want to talk to Support Engineer / Developrt because it looks like a bug in HA configuration or like a case which was not properly tested by R&D<br>\n  * This problem at the moment affects only one customer - UM Lubin (20339-77MKN-ZIFC1), beacause probably no more customers use HA with WAN link failover.<br>\n  <br>"
        ]
      ],
      "diagnostics": {
        "kayako": {
          "requester_ok": true,
          "ticket_ok": true,
          "ticket_has_custom_fields": true,
          "ticket_translog_items": 41,
          "side_conversation_items": 0
        },
        "jira": {
          "link_present": false,
          "link_value": ""
        },
        "github": {
          "link_present": true,
          "link_value": "https://github.com/trilogy-group/eng-maintenance/issues/15673"
        }
      }
    },
    "similar_tickets": []
  }
}